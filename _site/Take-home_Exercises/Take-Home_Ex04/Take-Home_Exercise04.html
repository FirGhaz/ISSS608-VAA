<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="FirGhaz">
<meta name="dcterms.date" content="2024-02-03">

<title>ISS608 - Big Mac Index Choropleth and Trade Network Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISS608</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About FirGhaz</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Journey in VAA</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">☀️Hands-On Exercises</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03(a)/Hands-on_Ex03(a).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 3(a)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03(b)/Hands-on_Ex03(b).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 3(b)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04(a)/Hands-on_Ex04(a).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 4(a)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04(b)/Hands-on_Ex04(b).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 4(b)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04(c)/Hands-on_Ex04(c).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 4(c)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04(d)/Hands-on_Ex04(d).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 4(d)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05(a)/Hands-on_Ex05(a).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 5(a)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05(b)/Hands-on_Ex05(b).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 5(b)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05(c)/Hands-on_Ex05(c).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 5(c)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05(d)/Hands-on_Ex05(d).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 5(d)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05(e)/Hands-on_Ex05(e).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 5(e)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07(a)/Hands-on_Ex07(a).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 7(a)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07(b)/Hands-on_Ex07(b).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 7(b)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07(c)/Hands-on_Ex07(c).html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 7(c)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hands-On Exercise 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">⭐In-class Exercises</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html" rel="" target="">
 <span class="dropdown-text">In-Class Exercise 9</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">🌈Take-Home Exercises</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Exercises/Take-Home_Ex01/Take-home_Exercise01.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Exercises/Take-Home_Ex02/Take-home_Exercise02.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Exercises/Take-Home_Ex03/Take-home_Exercise03.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Exercises/Take-Home_Ex04/Take-home_Exercise04.html" rel="" target="">
 <span class="dropdown-text">Take-Home Exercise 4</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link active" data-scroll-target="#load-packages">1 Load Packages</a></li>
  <li><a href="#eda-trade-on-geo" id="toc-eda-trade-on-geo" class="nav-link" data-scroll-target="#eda-trade-on-geo">2 EDA Trade on GEO</a></li>
  <li><a href="#visualising-the-network-exploratory-data-analysis" id="toc-visualising-the-network-exploratory-data-analysis" class="nav-link" data-scroll-target="#visualising-the-network-exploratory-data-analysis">3 Visualising the Network: Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#network-centrality-and-community-clustering" id="toc-network-centrality-and-community-clustering" class="nav-link" data-scroll-target="#network-centrality-and-community-clustering">3.1 Network Centrality and Community Clustering</a></li>
  <li><a href="#computing-centrality" id="toc-computing-centrality" class="nav-link" data-scroll-target="#computing-centrality">3.2 Computing Centrality</a></li>
  <li><a href="#computing-community-indices" id="toc-computing-community-indices" class="nav-link" data-scroll-target="#computing-community-indices">3.3 Computing Community Indices</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Big Mac Index Choropleth and Trade Network Analysis</h1>
<p class="subtitle lead">Take Home Exercise 04</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>FirGhaz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 3, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>This exercise aims to develop a Shiny application featuring an interactive choropleth map to analyze global trade networks in conjunction with the Big Mac Index. By integrating geographical data with economic indicators, the application will enable a visual exploration of how trade volumes and net exports correlate with price parity across different regions. The choropleth will serve as a dynamic tool to observe patterns, offering users the ability to drill down into country-specific trade connections and Index values.</p>
<p>The final deliverable will be a user-centric Shiny application, optimized for engagement and insight discovery. It will be complemented by a concise report summarizing the analytical narratives that emerge from the visualization. This endeavor will not only underscore the practicality of geospatial data in economic analysis but also aims to enrich the discourse on the implications of trade dynamics for market pricing mechanisms like the Big Mac Index.</p>
<section id="load-packages" class="level1">
<h1>1 Load Packages</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(countrycode)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cartogram)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="eda-trade-on-geo" class="level1">
<h1>2 EDA Trade on GEO</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>worldly<span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"C:/FirGhaz/ISSS608-VAA/Take-home_Exercises/Take-Home_Ex04/data/geospatial/TM_WORLD_BORDERS-0.3.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `TM_WORLD_BORDERS-0.3' from data source 
  `C:\FirGhaz\ISSS608-VAA\Take-home_Exercises\Take-Home_Ex04\data\geospatial\TM_WORLD_BORDERS-0.3.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 246 features and 11 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -180 ymin: -90 xmax: 180 ymax: 83.6236
Geodetic CRS:  WGS 84</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>worldly_projected <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(worldly, <span class="st">"+proj=robin"</span>)  </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:/FirGhaz/ISSS608-VAA/Take-home_Exercises/Take-Home_Ex04/data/bmi_data_2021_carto.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>map_pre <span class="ot">&lt;-</span> worldly_projected<span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>clean <span class="ot">&lt;-</span> data<span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">iso_a3 =</span><span class="st">'ISO3'</span>,<span class="at">bmi_usd_price=</span>bmi_usd_price, <span class="at">total_trade=</span>total_trade, <span class="at">import_usd=</span>import_usd, export_usd,)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Join data to world map</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> map_pre<span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(clean)<span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(country, id, year, continent, iso_a3))<span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(bmi_usd_price<span class="sc">:</span>population), <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>, .)))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#drop_na(bmi_usd_price)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#st_write(map, "C:/FirGhaz/ISSS608-VAA/Take-home_Exercises/Take-Home_Ex04/data/map2021_data.csv")</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(map, <span class="fu">aes</span>(<span class="at">fill=</span>total_trade))<span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dorl<span class="ot">&lt;-</span>cartogram<span class="sc">::</span><span class="fu">cartogram_dorling</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  map, <span class="at">weight=</span><span class="st">'total_trade'</span>, <span class="at">k =</span> <span class="dv">3</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">m_weight =</span> <span class="dv">1</span>, <span class="at">itermax =</span> <span class="dv">1000</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Set colors</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>col_world <span class="ot">&lt;-</span> <span class="st">"#9CB4BF"</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>col_back <span class="ot">&lt;-</span> <span class="st">"#1D201F"</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>theme_custom <span class="ot">&lt;-</span> <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span>col_back,<span class="at">color=</span><span class="cn">NA</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>dorl<span class="ot">&lt;-</span>dorl<span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute area</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">ar=</span><span class="fu">as.numeric</span>(<span class="fu">st_area</span>(dorl)),</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute radius based on area</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">rad=</span><span class="fu">as.numeric</span>(<span class="fu">sqrt</span>(ar<span class="sc">/</span>pi))</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract centroids for each circle</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>centr <span class="ot">&lt;-</span> dorl<span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_centroid</span>()<span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_coordinates</span>()</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine data</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>dorl2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(dorl,<span class="at">X=</span>centr[,<span class="dv">1</span>],<span class="at">Y=</span>centr[,<span class="dv">2</span>])<span class="sc">%&gt;%</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>total_trade)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(map)<span class="sc">+</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># World basemap</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>    worldly,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">geometry=</span>geometry),</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>col_world,<span class="at">color=</span><span class="fu">alpha</span>(<span class="st">"dimgrey"</span>,<span class="fl">0.25</span>)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw Dorling cartogram with geom_circle()</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_circle</span>(</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dorl2, <span class="fu">aes</span>(<span class="at">x0 =</span> X, <span class="at">y0 =</span> Y, <span class="at">r =</span> rad),</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"dimgrey"</span>,<span class="fl">0.75</span>),<span class="at">color=</span><span class="fu">alpha</span>(<span class="st">"white"</span>,<span class="fl">0.2</span>)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>  theme_custom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dorl2 <span class="ot">&lt;-</span> dorl2 <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_export =</span> export_usd <span class="sc">/</span>total_trade,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ratio_import =</span> import_usd<span class="sc">/</span>total_trade</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">rad_export=</span><span class="fu">sqrt</span>(rad<span class="sc">*</span>rad<span class="sc">*</span>ratio_export),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">rad_import=</span><span class="fu">sqrt</span>(rad<span class="sc">*</span>rad<span class="sc">*</span>ratio_import)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>col_export <span class="ot">&lt;-</span> <span class="st">"#f2e901"</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>col_import <span class="ot">&lt;-</span> <span class="st">"#FF4843"</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(map)<span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># World basemap</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    worldly,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">geometry=</span>geometry),</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>col_world,<span class="at">color=</span><span class="fu">alpha</span>(<span class="st">"dimgrey"</span>,<span class="fl">0.25</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw Dorling cartogram with geom_circle()</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_circle</span>(</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dorl2, <span class="fu">aes</span>(<span class="at">x0 =</span> X, <span class="at">y0 =</span> Y, <span class="at">r =</span> rad),</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"dimgrey"</span>,<span class="fl">0.75</span>),<span class="at">color=</span><span class="fu">alpha</span>(<span class="st">"white"</span>,<span class="fl">0.2</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw circle for crops (or grass)</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_circle</span>(</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dorl2, <span class="fu">aes</span>(<span class="at">x0 =</span> X, <span class="at">y0 =</span> Y, <span class="at">r =</span> rad_export),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>col_export,<span class="at">color=</span><span class="cn">NA</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  theme_custom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>circleFun <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">center=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),   <span class="co"># center of the circle </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">diameter=</span><span class="dv">1</span>,      <span class="co"># diameter </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">npoints=</span><span class="dv">100</span>,     <span class="co"># number of points to draw the circle</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">start=</span><span class="dv">0</span>, <span class="at">end=</span><span class="dv">2</span>   <span class="co"># start point/end point</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  ){</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(start<span class="sc">*</span>pi, end<span class="sc">*</span>pi, <span class="at">length.out=</span>npoints)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> center[<span class="dv">1</span>] <span class="sc">+</span> diameter <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">cos</span>(tt), </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> center[<span class="dv">2</span>] <span class="sc">+</span> diameter <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sin</span>(tt)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(tb)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>half_export <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">ISO3 =</span> <span class="fu">rep</span>(dorl2<span class="sc">$</span>ISO3[<span class="dv">1</span>],<span class="dv">100</span>),</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circleFun</span>(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(dorl2<span class="sc">$</span>X[<span class="dv">1</span>],dorl2<span class="sc">$</span>Y[<span class="dv">1</span>]),dorl2<span class="sc">$</span>rad_export[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">2</span>, <span class="at">start=</span><span class="fl">1.5</span>, <span class="at">end=</span><span class="fl">2.5</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>half_import <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">ISO3 =</span> <span class="fu">rep</span>(dorl2<span class="sc">$</span>ISO3[<span class="dv">1</span>],<span class="dv">100</span>),</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">circleFun</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(dorl2<span class="sc">$</span>X[<span class="dv">1</span>],dorl2<span class="sc">$</span>Y[<span class="dv">1</span>]),dorl2<span class="sc">$</span>rad_import[<span class="dv">1</span>]<span class="sc">*</span><span class="dv">2</span>, <span class="at">start=</span><span class="fl">0.5</span>, <span class="at">end=</span><span class="fl">1.5</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>col_world <span class="ot">&lt;-</span> <span class="st">"#9CB4BF"</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>col_back <span class="ot">&lt;-</span> <span class="st">"#1D201F"</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>theme_custom <span class="ot">&lt;-</span> <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span>col_back,<span class="at">color=</span><span class="cn">NA</span>))</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Make loop for all countries</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(dorl2)[<span class="dv">1</span>]){</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw for exports</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>  temp_export <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">ISO3 =</span> <span class="fu">rep</span>(dorl2<span class="sc">$</span>ISO3[i],<span class="dv">100</span>),</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circleFun</span>(</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(dorl2<span class="sc">$</span>X[i],dorl2<span class="sc">$</span>Y[i]),dorl2<span class="sc">$</span>rad_export[i]<span class="sc">*</span><span class="dv">2</span>, <span class="at">start=</span><span class="fl">1.5</span>, <span class="at">end=</span><span class="fl">2.5</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw for imports</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>  temp_import <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">ISO3 =</span> <span class="fu">rep</span>(dorl2<span class="sc">$</span>ISO3[i],<span class="dv">100</span>),</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circleFun</span>(</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(dorl2<span class="sc">$</span>X[i],dorl2<span class="sc">$</span>Y[i]),dorl2<span class="sc">$</span>rad_import[i]<span class="sc">*</span><span class="dv">2</span>, <span class="at">start=</span><span class="fl">0.5</span>, <span class="at">end=</span><span class="fl">1.5</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>  half_export<span class="ot">&lt;-</span>half_export<span class="sc">%&gt;%</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(temp_export)</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  half_import<span class="ot">&lt;-</span>half_import<span class="sc">%&gt;%</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(temp_import)</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Make map</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(map)<span class="sc">+</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># World basemap</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    worldly,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">geometry=</span>geometry),</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>col_world,<span class="at">color=</span><span class="fu">alpha</span>(<span class="st">"dimgrey"</span>,<span class="fl">0.25</span>)</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw Dorling cartogram with geom_circle()</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_circle</span>(</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dorl2, <span class="fu">aes</span>(<span class="at">x0 =</span> X, <span class="at">y0 =</span> Y, <span class="at">r =</span> rad),</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"dimgrey"</span>,<span class="fl">0.75</span>),<span class="at">color=</span><span class="fu">alpha</span>(<span class="st">"white"</span>,<span class="fl">0.2</span>)</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw half circle for crop with geom_polygon</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>    half_export,</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(x,y,<span class="at">group=</span>ISO3),</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>col_export,<span class="at">color=</span><span class="cn">NA</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span> </span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw half circle for grass with geom_polygon</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>    half_import,</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(x,y,<span class="at">group=</span>ISO3),</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>col_import,<span class="at">color=</span><span class="cn">NA</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span> </span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>  theme_custom</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>x_range <span class="ot">&lt;-</span> <span class="fu">range</span>(dorl2<span class="sc">$</span>X, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>y_range <span class="ot">&lt;-</span> <span class="fu">range</span>(dorl2<span class="sc">$</span>Y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate positions for legend items based on the range</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>legend_x <span class="ot">&lt;-</span> x_range[<span class="dv">1</span>] <span class="sc">*</span> <span class="fl">1.20</span> <span class="co"># Place legend slightly to the right of the X range minimum</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>legend_y_total_trade <span class="ot">&lt;-</span> y_range[<span class="dv">1</span>] <span class="sc">*</span> <span class="fl">1.15</span> <span class="co"># Start legend slightly above the Y range minimum</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>legend_y_exports <span class="ot">&lt;-</span> legend_y_total_trade <span class="sc">+</span> <span class="fu">abs</span>(y_range[<span class="dv">2</span>] <span class="sc">-</span> y_range[<span class="dv">1</span>]) <span class="sc">*</span> <span class="fl">0.05</span> <span class="co"># 5% above total trade</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>legend_y_imports <span class="ot">&lt;-</span> legend_y_exports <span class="sc">+</span> <span class="fu">abs</span>(y_range[<span class="dv">2</span>] <span class="sc">-</span> y_range[<span class="dv">1</span>]) <span class="sc">*</span> <span class="fl">0.05</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> legend_x, <span class="at">y =</span> legend_y_total_trade, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">fill =</span> <span class="st">"dimgrey"</span>, <span class="at">colour =</span> <span class="st">"dimgrey"</span> ) <span class="sc">+</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> legend_x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> legend_y_total_trade, <span class="at">label =</span> <span class="st">"Total Trade         1 billion(US)"</span>, <span class="at">hjust =</span> <span class="fl">0.52</span>, <span class="at">vjust =</span> <span class="fl">1.6</span>, <span class="at">colour =</span> <span class="st">"grey"</span>, <span class="at">size=</span><span class="fl">3.7</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Arial"</span> ) <span class="sc">+</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> legend_x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> legend_y_exports, <span class="at">label =</span> <span class="st">"Exports"</span>, <span class="at">hjust =</span> <span class="fl">1.8</span>, <span class="at">vjust =</span> <span class="fl">1.2</span>, <span class="at">colour =</span> <span class="st">"#f2e901"</span>, <span class="at">size=</span><span class="fl">3.7</span>,<span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Arial"</span>) <span class="sc">+</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> legend_x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> legend_y_imports, <span class="at">label =</span> <span class="st">"Imports"</span>, <span class="at">hjust =</span> <span class="fl">1.8</span>, <span class="at">vjust =</span> <span class="fl">0.8</span>, <span class="at">colour =</span> <span class="st">"#FF4843"</span>, <span class="at">size=</span><span class="fl">3.7</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Arial"</span>) <span class="sc">+</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> legend_x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> legend_y_imports, <span class="at">label =</span> <span class="st">"Trade 2021"</span>, <span class="at">hjust =</span> <span class="fl">1.16</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">size=</span><span class="fl">4.5</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">family =</span> <span class="st">"Arial"</span>) <span class="sc">+</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>  theme_custom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>bmi_node_2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'C:/FirGhaz/ISSS608-VAA/Take-home_Exercises/Take-Home_Ex04/data/bmi_node_2021_add.csv'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>bmi_edges_2021 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'C:/FirGhaz/ISSS608-VAA/Take-home_Exercises/Take-Home_Ex04/data/import_export_beef_edges5-2021.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce) </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps) </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geosphere)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'bmi_node_2021' is your dataframe and it has columns 'LON' and 'LAT'</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure 'bmi_node_2021' is a data frame and 'LON' and 'LAT' are not factors</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>bmi_node_2021a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(bmi_node_2021)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>bmi_node_2021a<span class="sc">$</span>LON <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(bmi_node_2021a<span class="sc">$</span>LON))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>bmi_node_2021a<span class="sc">$</span>LAT <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(bmi_node_2021a<span class="sc">$</span>LAT))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert your data frame to an sf object</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>node_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(bmi_node_2021a, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LON"</span>, <span class="st">"LAT"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>node_sf_projected <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(node_sf, <span class="fu">st_crs</span>(worldly_projected))</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>bmi_edges_2021<span class="sc">$</span>source_lon <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bmi_edges_2021<span class="sc">$</span>source_lon)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>bmi_edges_2021<span class="sc">$</span>source_lat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bmi_edges_2021<span class="sc">$</span>source_lat)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>bmi_edges_2021<span class="sc">$</span>target_lon <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bmi_edges_2021<span class="sc">$</span>target_lon)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>bmi_edges_2021<span class="sc">$</span>target_lat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(bmi_edges_2021<span class="sc">$</span>target_lat)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>col_world <span class="ot">&lt;-</span> <span class="st">"#9CB4BF"</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>col_back <span class="ot">&lt;-</span> <span class="st">"#1D201F"</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>theme_custom <span class="ot">&lt;-</span> <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span>col_back,<span class="at">color=</span><span class="cn">NA</span>))</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a LINESTRING for each row in bmi_edges_2021</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>edges_linestrings <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(bmi_edges_2021), <span class="cf">function</span>(i) {</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  row <span class="ot">&lt;-</span> bmi_edges_2021[i, ]</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_linestring</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(row<span class="sc">$</span>source_lon, row<span class="sc">$</span>source_lat, row<span class="sc">$</span>target_lon, row<span class="sc">$</span>target_lat), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list of LINESTRINGs to an sf object</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>edges_sf <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(edges_linestrings, <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a data frame structure for sf, if needed</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>edges_sf_df <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="at">geometry =</span> edges_sf)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to the same CRS as the base map</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>edges_sf_projected <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(edges_sf_df, <span class="fu">st_crs</span>(worldly_projected))</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>col<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">adjustcolor</span>(<span class="st">"orangered"</span>, <span class="at">alpha=</span><span class="fl">0.02</span>)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>col<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">adjustcolor</span>(<span class="st">"yellow"</span>, <span class="at">alpha=</span><span class="fl">0.02</span>)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>edge.pal <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(col<span class="fl">.1</span>, col<span class="fl">.2</span>), <span class="at">alpha =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'Weight' is normalized between 0 and 1 for color mapping</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>max_weight <span class="ot">&lt;-</span> <span class="fu">max</span>(bmi_edges_2021<span class="sc">$</span>Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>edge.col <span class="ot">&lt;-</span> <span class="fu">edge.pal</span>(<span class="dv">1000000</span>)[<span class="fu">round</span>(<span class="dv">1000000</span> <span class="sc">*</span> bmi_edges_2021<span class="sc">$</span>Value <span class="sc">/</span> max_weight)]</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate arc data</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>arc_data <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(bmi_edges_2021), <span class="cf">function</span>(i) {</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  row <span class="ot">&lt;-</span> bmi_edges_2021[i,]</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>  arc <span class="ot">&lt;-</span> <span class="fu">gcIntermediate</span>(</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(row<span class="sc">$</span>source_lon, row<span class="sc">$</span>source_lat),</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(row<span class="sc">$</span>target_lon, row<span class="sc">$</span>target_lat),</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">n=</span><span class="dv">300</span>, <span class="at">addStartEnd=</span><span class="cn">TRUE</span>, <span class="at">breakAtDateLine=</span>F</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">lon =</span> arc[,<span class="dv">1</span>], <span class="at">lat =</span> arc[,<span class="dv">2</span>], <span class="at">weight =</span> row<span class="sc">$</span>Value, <span class="at">edge_col =</span> edge.col[i])</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind, .)</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert arc data to an sf object and project</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>arc_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(arc_data, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>arc_sf_projected <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(arc_sf, <span class="fu">st_crs</span>(worldly_projected))</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(map) <span class="sc">+</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> worldly_projected, <span class="at">fill =</span> col_world, <span class="at">color =</span> <span class="fu">alpha</span>(<span class="st">"dimgrey"</span>, <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> node_sf_projected, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> arc_sf_projected, <span class="fu">aes</span>(<span class="at">color =</span> edge_col), <span class="at">size =</span> <span class="fl">0.0001</span>) <span class="sc">+</span>  <span class="co"># Assuming 'edge_col' is part of 'arc_sf_projected'</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_identity</span>() <span class="sc">+</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw Dorling cartogram with geom_circle()</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_circle</span>(</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> dorl2, <span class="fu">aes</span>(<span class="at">x0 =</span> X, <span class="at">y0 =</span> Y, <span class="at">r =</span> rad),</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span><span class="fu">alpha</span>(<span class="st">"dimgrey"</span>,<span class="fl">0.75</span>),<span class="at">color=</span><span class="fu">alpha</span>(<span class="st">"white"</span>,<span class="fl">0.2</span>)</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw half circle for crop with geom_polygon</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>    half_export,</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(x,y,<span class="at">group=</span>ISO3),</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>col_export,<span class="at">color=</span><span class="cn">NA</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span> </span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw half circle for grass with geom_polygon</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>    half_import,</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(x,y,<span class="at">group=</span>ISO3),</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill=</span>col_import,<span class="at">color=</span><span class="cn">NA</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span> </span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>  theme_custom</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>x_range <span class="ot">&lt;-</span> <span class="fu">range</span>(dorl2<span class="sc">$</span>X, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>y_range <span class="ot">&lt;-</span> <span class="fu">range</span>(dorl2<span class="sc">$</span>Y, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate positions for legend items based on the range</span></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>legend_x <span class="ot">&lt;-</span> x_range[<span class="dv">1</span>] <span class="sc">*</span> <span class="fl">1.20</span> <span class="co"># Place legend slightly to the right of the X range minimum</span></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>legend_y_total_trade <span class="ot">&lt;-</span> y_range[<span class="dv">1</span>] <span class="sc">*</span> <span class="fl">1.15</span> <span class="co"># Start legend slightly above the Y range minimum</span></span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>legend_y_exports <span class="ot">&lt;-</span> legend_y_total_trade <span class="sc">+</span> <span class="fu">abs</span>(y_range[<span class="dv">2</span>] <span class="sc">-</span> y_range[<span class="dv">1</span>]) <span class="sc">*</span> <span class="fl">0.05</span> <span class="co"># 5% above total trade</span></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>legend_y_imports <span class="ot">&lt;-</span> legend_y_exports <span class="sc">+</span> <span class="fu">abs</span>(y_range[<span class="dv">2</span>] <span class="sc">-</span> y_range[<span class="dv">1</span>]) <span class="sc">*</span> <span class="fl">0.05</span></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> legend_x, <span class="at">y =</span> legend_y_total_trade, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">fill =</span> <span class="st">"dimgrey"</span>, <span class="at">colour =</span> <span class="st">"dimgrey"</span> ) <span class="sc">+</span></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> legend_x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> legend_y_total_trade, <span class="at">label =</span> <span class="st">"Total Trade     1 billion(US)"</span>, <span class="at">hjust =</span> <span class="fl">0.52</span>, <span class="at">vjust =</span> <span class="fl">1.6</span>, <span class="at">colour =</span> <span class="st">"grey"</span>, <span class="at">size=</span><span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Arial"</span> ) <span class="sc">+</span> </span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> legend_x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> legend_y_total_trade, <span class="at">label =</span> <span class="st">"Beef Trade --"</span>, <span class="at">hjust =</span> <span class="fl">1.07</span>, <span class="at">vjust =</span> <span class="fl">2.9</span>, <span class="at">colour =</span> <span class="st">"orangered"</span>, <span class="at">size=</span><span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Arial"</span> ) <span class="sc">+</span></span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> legend_x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> legend_y_exports, <span class="at">label =</span> <span class="st">"Exports"</span>, <span class="at">hjust =</span> <span class="fl">1.8</span>, <span class="at">vjust =</span> <span class="fl">1.2</span>, <span class="at">colour =</span> <span class="st">"#f2e901"</span>, <span class="at">size=</span><span class="fl">3.5</span>,<span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Arial"</span>) <span class="sc">+</span></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> legend_x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> legend_y_imports, <span class="at">label =</span> <span class="st">"Imports"</span>, <span class="at">hjust =</span> <span class="fl">1.8</span>, <span class="at">vjust =</span> <span class="fl">0.8</span>, <span class="at">colour =</span> <span class="st">"#FF4843"</span>, <span class="at">size=</span><span class="fl">3.5</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Arial"</span>) <span class="sc">+</span></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> legend_x <span class="sc">+</span> <span class="dv">1</span>, <span class="at">y =</span> legend_y_imports, <span class="at">label =</span> <span class="st">"Trade Network 2021"</span>, <span class="at">hjust =</span> <span class="fl">0.58</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">size=</span><span class="fl">4.3</span>, <span class="at">fontface =</span> <span class="st">"italic"</span>, <span class="at">family =</span> <span class="st">"Arial"</span>) <span class="sc">+</span></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>theme_custom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="visualising-the-network-exploratory-data-analysis" class="level1">
<h1>3 Visualising the Network: Exploratory Data Analysis</h1>
<p>Emphasis here is to give them the option to play with the nodes, layout and geom_edge functions.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bmi2021_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> bmi_node_2021,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">edges =</span> bmi_edges_2021, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">directed =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#this are the node attributes</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>bmi_usd_price <span class="ot">&lt;-</span> bmi_node_2021<span class="sc">$</span>bmi_usd_price</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>gdp_per_capita<span class="ot">&lt;-</span> bmi_node_2021<span class="sc">$</span>gdp_per_capita</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>inflation <span class="ot">&lt;-</span> bmi_node_2021<span class="sc">$</span>inflation</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(bmi2021_graph, <span class="at">layout =</span> <span class="st">"kk"</span>) <span class="sc">+</span> <span class="co">#layout options = kk, fr, nicely,</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>bmi_usd_price , <span class="at">size =</span> <span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>bmi_usd_price, <span class="at">color =</span> continent, <span class="at">show.legend=</span><span class="cn">FALSE</span>),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                  )<span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link2</span>(<span class="fu">aes</span>(<span class="at">color =</span> Trade, <span class="at">width =</span> Value), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Import Quantity"</span> <span class="ot">=</span> <span class="st">"#00CCB0"</span>, <span class="st">"Export Quantity"</span> <span class="ot">=</span> <span class="st">"#FF6ABE"</span>)) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">hjust =</span> <span class="fl">0.6</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.8</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>(<span class="at">background =</span> <span class="st">'#1D201F'</span>, <span class="at">text_colour =</span> <span class="st">'white'</span>) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Type"</span>),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">edge_width =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"white"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ggproto object: Class CoordFixed, CoordCartesian, Coord, gg&gt;
    aspect: function
    backtransform_range: function
    clip: on
    default: FALSE
    distance: function
    expand: TRUE
    is_free: function
    is_linear: function
    labels: function
    limits: list
    modify_scales: function
    range: function
    ratio: 1
    render_axis_h: function
    render_axis_v: function
    render_bg: function
    render_fg: function
    setup_data: function
    setup_layout: function
    setup_panel_guides: function
    setup_panel_params: function
    setup_params: function
    train_panel_guides: function
    transform: function
    super:  &lt;ggproto object: Class CoordFixed, CoordCartesian, Coord, gg&gt;</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmlwidgets)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>nodes_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>country, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">label =</span> <span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>country,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">value =</span> <span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>bmi_usd_price, <span class="co">#to change to inflation, gdp</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">group =</span> <span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>continent,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"&lt;b&gt;BMI:&lt;/b&gt;"</span>, <span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>bmi_usd_price,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"&lt;br&gt;&lt;b&gt;GDP:&lt;/b&gt;"</span>, <span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>gdp_per_capita,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"&lt;br&gt;&lt;b&gt;Inf:&lt;/b&gt;"</span>, <span class="fu">V</span>(bmi2021_graph)<span class="sc">$</span>inflation))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame for edges that visNetwork can use</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>edges_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from =</span> bmi_edges_2021<span class="sc">$</span>Origin, </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">to =</span> bmi_edges_2021<span class="sc">$</span>Partners,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">value =</span> bmi_edges_2021<span class="sc">$</span>Value,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">title =</span> bmi_edges_2021<span class="sc">$</span>Trade,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                         <span class="at">arrows =</span> <span class="st">'to'</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let's create the visNetwork graph</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> <span class="fu">visNetwork</span>(nodes_data, edges_data, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">size =</span> <span class="st">"bmi_usd_price"</span>, <span class="at">shadow =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"white"</span>, <span class="at">border =</span> <span class="st">"#2B7CE9"</span>),</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">font =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"white"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">smooth =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#A5ABB6"</span>, <span class="at">highlight =</span> <span class="st">"#FF4F09"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add custom CSS to change the background color</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>network <span class="ot">&lt;-</span> network <span class="sc">%&gt;%</span> </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  htmlwidgets<span class="sc">::</span><span class="fu">onRender</span>(<span class="st">"</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="st">    function(el, x) {</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="st">      el.style.backgroundColor = 'black';</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a><span class="st">  "</span>)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the network to display it</span></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>network</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-bfd4b740981329cdc5f5" style="width:100%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-bfd4b740981329cdc5f5">{"x":{"nodes":{"id":["Lebanon","Argentina","Turkey","Ghana","Ukraine","Brazil","Uruguay","Russia","Mexico","Egypt","Hungary","Poland","India","United States","South Africa","Chile","Peru","Kuwait","New Zealand","Philippines","Czech Republic","Canada","Germany","Spain","Saudi Arabia","Australia","Austria","Netherlands","Croatia","United Kingdom","United Arab Emirates","South Korea","Malaysia","Belgium","Singapore","Qatar","Sweden","Oman","Denmark","Viet Nam","Costa Rica","Hong Kong","France","Indonesia","Israel","Portugal","Jordan","Greece","Thailand","China","Switzerland","Bahrain","Japan"],"label":["Lebanon","Argentina","Turkey","Ghana","Ukraine","Brazil","Uruguay","Russia","Mexico","Egypt","Hungary","Poland","India","United States","South Africa","Chile","Peru","Kuwait","New Zealand","Philippines","Czech Republic","Canada","Germany","Spain","Saudi Arabia","Australia","Austria","Netherlands","Croatia","United Kingdom","United Arab Emirates","South Korea","Malaysia","Belgium","Singapore","Qatar","Sweden","Oman","Denmark","Viet Nam","Costa Rica","Hong Kong","France","Indonesia","Israel","Portugal","Jordan","Greece","Thailand","China","Switzerland","Bahrain","Japan"],"value":[5.08,3.75,2.01,2.16,2.2,3.98,4.8,1.81,2.68,2.72,3.03,3.51,2.59,4.89,2.16,4.09,3.29,3.79,4.87,2.95,4.12,5.29,5.16,5.16,3.73,4.98,5.16,5.16,3.69,4.44,4.02,4.1,2.47,5.16,4.43,3.57,6.37,2.86,4.9,2.86,3.83,2.64,5.16,2.41,5.35,5.16,3.24,5.16,4.25,3.46,7.29,3.98,3.74],"group":["Asia","South America","Asia","Africa","Europe","South America","South America","Europe","North America","Africa","Europe","Europe","Asia","North America","Africa","South America","South America","Asia","Oceania","Asia","Europe","North America","Europe","Europe","Asia","Oceania","Europe","Europe","Europe","Europe","Asia","Asia","Asia","Europe","Asia","Asia","Europe","Asia","Europe","Asia","North America","Asia","Europe","Asia","Asia","Europe","Asia","Europe","Asia","Asia","Europe","Asia","Asia"],"title":["<b>BMI:<\/b> 5.08 <br><b>GDP:<\/b> 4136.2 <br><b>Inf:<\/b> 154.8","<b>BMI:<\/b> 3.75 <br><b>GDP:<\/b> 10650.9 <br><b>Inf:<\/b> 48.4","<b>BMI:<\/b> 2.01 <br><b>GDP:<\/b> 9743.2 <br><b>Inf:<\/b> 19.6","<b>BMI:<\/b> 2.16 <br><b>GDP:<\/b> 2363.3 <br><b>Inf:<\/b> 10","<b>BMI:<\/b> 2.2 <br><b>GDP:<\/b> 4835.6 <br><b>Inf:<\/b> 9.4","<b>BMI:<\/b> 3.98 <br><b>GDP:<\/b> 7696.8 <br><b>Inf:<\/b> 8.3","<b>BMI:<\/b> 4.8 <br><b>GDP:<\/b> 17313.2 <br><b>Inf:<\/b> 7.8","<b>BMI:<\/b> 1.81 <br><b>GDP:<\/b> 12532.1 <br><b>Inf:<\/b> 6.7","<b>BMI:<\/b> 2.68 <br><b>GDP:<\/b> 10359.1 <br><b>Inf:<\/b> 5.7","<b>BMI:<\/b> 2.72 <br><b>GDP:<\/b> 3698.8 <br><b>Inf:<\/b> 5.2","<b>BMI:<\/b> 3.03 <br><b>GDP:<\/b> 18753 <br><b>Inf:<\/b> 5.1","<b>BMI:<\/b> 3.51 <br><b>GDP:<\/b> 18050.3 <br><b>Inf:<\/b> 5.1","<b>BMI:<\/b> 2.59 <br><b>GDP:<\/b> 2256.6 <br><b>Inf:<\/b> 4.9","<b>BMI:<\/b> 4.89 <br><b>GDP:<\/b> 70219.5 <br><b>Inf:<\/b> 4.7","<b>BMI:<\/b> 2.16 <br><b>GDP:<\/b> 7073.6 <br><b>Inf:<\/b> 4.6","<b>BMI:<\/b> 4.09 <br><b>GDP:<\/b> 16240.6 <br><b>Inf:<\/b> 4.5","<b>BMI:<\/b> 3.29 <br><b>GDP:<\/b> 6635.5 <br><b>Inf:<\/b> 4.3","<b>BMI:<\/b> 3.79 <br><b>GDP:<\/b> 32187 <br><b>Inf:<\/b> 4","<b>BMI:<\/b> 4.87 <br><b>GDP:<\/b> 49996.4 <br><b>Inf:<\/b> 3.9","<b>BMI:<\/b> 2.95 <br><b>GDP:<\/b> 3460.5 <br><b>Inf:<\/b> 3.9","<b>BMI:<\/b> 4.12 <br><b>GDP:<\/b> 26822.5 <br><b>Inf:<\/b> 3.8","<b>BMI:<\/b> 5.29 <br><b>GDP:<\/b> 52358.6 <br><b>Inf:<\/b> 3.4","<b>BMI:<\/b> 5.16 <br><b>GDP:<\/b> 51203.6 <br><b>Inf:<\/b> 3.1","<b>BMI:<\/b> 5.16 <br><b>GDP:<\/b> 30103.5 <br><b>Inf:<\/b> 3.1","<b>BMI:<\/b> 3.73 <br><b>GDP:<\/b> 23185.9 <br><b>Inf:<\/b> 3.1","<b>BMI:<\/b> 4.98 <br><b>GDP:<\/b> 60697.2 <br><b>Inf:<\/b> 2.9","<b>BMI:<\/b> 5.16 <br><b>GDP:<\/b> 53637.7 <br><b>Inf:<\/b> 2.8","<b>BMI:<\/b> 5.16 <br><b>GDP:<\/b> 57767.9 <br><b>Inf:<\/b> 2.7","<b>BMI:<\/b> 3.69 <br><b>GDP:<\/b> 17685.3 <br><b>Inf:<\/b> 2.6","<b>BMI:<\/b> 4.44 <br><b>GDP:<\/b> 46869.8 <br><b>Inf:<\/b> 2.5","<b>BMI:<\/b> 4.02 <br><b>GDP:<\/b> 44315.6 <br><b>Inf:<\/b> 2.5","<b>BMI:<\/b> 4.1 <br><b>GDP:<\/b> 35142.3 <br><b>Inf:<\/b> 2.5","<b>BMI:<\/b> 2.47 <br><b>GDP:<\/b> 11134.6 <br><b>Inf:<\/b> 2.5","<b>BMI:<\/b> 5.16 <br><b>GDP:<\/b> 51274 <br><b>Inf:<\/b> 2.4","<b>BMI:<\/b> 4.43 <br><b>GDP:<\/b> 77710.1 <br><b>Inf:<\/b> 2.3","<b>BMI:<\/b> 3.57 <br><b>GDP:<\/b> 66838.4 <br><b>Inf:<\/b> 2.3","<b>BMI:<\/b> 6.37 <br><b>GDP:<\/b> 61417.7 <br><b>Inf:<\/b> 2.2","<b>BMI:<\/b> 2.86 <br><b>GDP:<\/b> 19509.5 <br><b>Inf:<\/b> 2.2","<b>BMI:<\/b> 4.9 <br><b>GDP:<\/b> 69268.7 <br><b>Inf:<\/b> 1.9","<b>BMI:<\/b> 2.86 <br><b>GDP:<\/b> 3756.5 <br><b>Inf:<\/b> 1.8","<b>BMI:<\/b> 3.83 <br><b>GDP:<\/b> 12472.4 <br><b>Inf:<\/b> 1.7","<b>BMI:<\/b> 2.64 <br><b>GDP:<\/b> 49764.8 <br><b>Inf:<\/b> 1.6","<b>BMI:<\/b> 5.16 <br><b>GDP:<\/b> 43659 <br><b>Inf:<\/b> 1.6","<b>BMI:<\/b> 2.41 <br><b>GDP:<\/b> 4334.2 <br><b>Inf:<\/b> 1.6","<b>BMI:<\/b> 5.35 <br><b>GDP:<\/b> 52170.7 <br><b>Inf:<\/b> 1.5","<b>BMI:<\/b> 5.16 <br><b>GDP:<\/b> 24567.5 <br><b>Inf:<\/b> 1.3","<b>BMI:<\/b> 3.24 <br><b>GDP:<\/b> 4103.3 <br><b>Inf:<\/b> 1.3","<b>BMI:<\/b> 5.16 <br><b>GDP:<\/b> 20192.6 <br><b>Inf:<\/b> 1.2","<b>BMI:<\/b> 4.25 <br><b>GDP:<\/b> 7060.9 <br><b>Inf:<\/b> 1.2","<b>BMI:<\/b> 3.46 <br><b>GDP:<\/b> 12617.5 <br><b>Inf:<\/b> 1","<b>BMI:<\/b> 7.29 <br><b>GDP:<\/b> 93446.4 <br><b>Inf:<\/b> 0.6","<b>BMI:<\/b> 3.98 <br><b>GDP:<\/b> 26593 <br><b>Inf:<\/b> 0.6","<b>BMI:<\/b> 3.74 <br><b>GDP:<\/b> 39827.1 <br><b>Inf:<\/b> -0.2"]},"edges":{"from":["Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Russia","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Chile","Chile","Chile","Chile","Chile","Chile","Chile","Chile","Chile","Chile","Chile","Chile","China","China","China","China","China","China","China","China","China","China","China","China","China","China","China","China","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Czech Republic","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hungary","Hungary","Hungary","Hungary","Hungary","Hungary","Hungary","Hungary","Hungary","Hungary","Hungary","Indonesia","Indonesia","Indonesia","Indonesia","Indonesia","Indonesia","Indonesia","Indonesia","Indonesia","Indonesia","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Malaysia","Malaysia","Malaysia","Malaysia","Malaysia","Malaysia","Malaysia","Malaysia","Malaysia","Malaysia","Mexico","Mexico","Mexico","Mexico","Mexico","Mexico","Mexico","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","Peru","Peru","Peru","Peru","Peru","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Russia","Russia","Russia","Russia","Russia","Russia","Russia","Russia","Russia","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Korea","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Ghana","Greece","India","Thailand","Thailand","Thailand","Thailand","Thailand","Thailand","Thailand","Turkey","Turkey","Turkey","United Arab Emirates","United Kingdom","United Kingdom","South Korea","South Korea","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","Austria","Bahrain","Belgium","Costa Rica","Croatia","Denmark","Egypt","France","Germany","United States","Uruguay","Viet Nam","Israel","Jordan","Kuwait","Lebanon","Netherlands","Oman","Portugal","Qatar","Saudi Arabia","Spain","Ukraine"],"to":["Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Argentina","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Australia","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","Brazil","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United Kingdom","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Canada","Chile","Chile","Chile","Chile","Chile","Chile","Chile","Egypt","Egypt","Egypt","Egypt","Egypt","Egypt","Egypt","France","France","France","France","France","France","France","France","France","France","France","France","France","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","China","China","China","China","China","China","China","China","China","China","China","China","China","Czech Republic","Czech Republic","Czech Republic","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hong Kong","Hungary","Hungary","Hungary","Hungary","Hungary","Indonesia","Indonesia","Indonesia","Indonesia","Indonesia","Indonesia","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Japan","Malaysia","Malaysia","Malaysia","Malaysia","Malaysia","Malaysia","Mexico","Mexico","Mexico","Mexico","Mexico","Mexico","Mexico","Mexico","Mexico","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","New Zealand","Peru","Peru","Peru","Peru","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Philippines","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Poland","Russia","Russia","Russia","Russia","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","Singapore","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Africa","South Korea","South Korea","South Korea","South Korea","South Korea","South Korea","South Korea","Sweden","Switzerland","Switzerland","Switzerland","Switzerland","Switzerland","Thailand","Thailand","Thailand","Thailand","Thailand","Thailand","Thailand","Thailand","Thailand","Turkey","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United States","United Arab Emirates","United Arab Emirates","United Arab Emirates","United Arab Emirates","United Arab Emirates","United Arab Emirates","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Uruguay","Viet Nam","Viet Nam","Viet Nam","Viet Nam","Viet Nam","Viet Nam","Viet Nam","Viet Nam","Viet Nam","Viet Nam","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Bahrain","Bahrain","Bahrain","Bahrain","Bahrain","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Costa Rica","Costa Rica","Costa Rica","Croatia","Croatia","Croatia","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Denmark","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Germany","Ghana","Ghana","Ghana","Greece","Greece","India","India","India","India","India","India","India","India","India","Israel","Israel","Israel","Israel","Israel","Jordan","Jordan","Jordan","Jordan","Jordan","Jordan","Kuwait","Kuwait","United States","United States","Kuwait","Kuwait","Kuwait","Lebanon","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Oman","Oman","Oman","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Portugal","Qatar","Qatar","Qatar","Qatar","Qatar","Saudi Arabia","Saudi Arabia","Saudi Arabia","Saudi Arabia","Saudi Arabia","Saudi Arabia","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Peru","Philippines","Poland","Poland","Poland","Poland","Singapore","Singapore","South Africa","Ukraine","Ukraine","Ukraine","Thailand","Turkey","United Kingdom","United Kingdom","United Kingdom","United Kingdom","United States","United States","United States","United States","United States"],"value":[3207.31,7582.19,375.79,33084.88,316273.1,142.26,278.73,1737.84,257.42,567.48,21128.31,1843.39,21914.07,30732.91,12026.82,342.37,1056.48,708.01,998.0599999999999,6947.71,138375.04,162.45,6661.28,44174.09,165.88,233343.79,7608.46,509.69,4130.14,4849.36,32459.31,4643.5,323.91,138884.99,172.44,684.33,8992.4,143512.51,7468.06,14278.69,257.68,335.15,162.45,326.99,541.77,2017.47,1287.73,2431.35,4649.71,3068.51,1313.49,8915.73,23179.67,3142.12,7610.02,651.4,1985.39,5231.44,1314.55,110199.34,723140.42,648.87,130737.65,16616.3,6495.49,2792.09,45879.11,27979.02,23199.62,242.15,1107.79,7841.8,2818.63,9927.700000000001,86901.35000000001,46922.87,6393.15,22725.62,4367.42,704.5,862.4,648.87,64774.8,790.28,3978.17,148.88,33913.95,17124.49,1841.74,4280.9,484.59,11683.83,16839.05,978.3099999999999,29766.12,596.71,4187.38,7254.37,1693.97,336.94,1308.74,6257.39,1114.89,22863.56,3059.14,464.7,225.32,1714.51,113.56,3310.77,676.4400000000001,117.89,195.98,293.37,138709.46,222.88,165.06,4459.44,106.53,5504.6,327.42,578.6799999999999,4001.04,40,10156.22,159867.95,2337.6,678.28,318.78,7319.78,653.76,1840.29,894.97,20014.52,1688.15,5039.99,253.62,44009.37,7367.16,14637.27,12817.17,1791.26,6775.77,63810.87,288014.54,303.77,8570.65,9565.190000000001,612.39,1688.15,2425.43,712.24,954.46,3533.39,1093.7,33343.4,111000.7,684.26,2303.71,115.83,200.19,6116.68,5568.91,344.89,8863.85,157886.69,130.74,350284.47,128766.79,858475.1,17982.33,2378.99,731.48,275.05,144724.56,15054.39,6136.03,130723.05,202803.39,10091.45,616.75,298.52,10376.02,109.74,1148.93,1001.88,213.38,138.09,298.59,2320.03,2154.2,12229.94,1018.34,40,213.38,155.71,1778.16,9500.74,465.46,143.71,366.87,2002.58,154.58,698.86,145.8,272.96,712.05,6394.53,524.12,378.56,8856.41,850.2,1422.88,1250.03,1279.76,113.7,275.58,245.33,266.45,3330.22,23468.64,2804.62,386.98,3352.68,134.67,431.99,942.75,20034.18,1033.94,687.6799999999999,3429.94,2181.37,2601.7,149475.22,5913.29,6550.41,3441.95,815.89,4977.51,2258.66,140.97,1545.71,260.6,1466.07,111.93,35981.1,2012.35,3033.11,8886.389999999999,145.81,326.24,219.05,636.37,21488.7,3737.61,859.46,1233.59,223.28,592.03,4815.95,1016.64,536.46,387.23,5366.82,353.26,3213.42,321.77,121.19,536.46,201.61,1546.41,54687.54,15911.94,40,128.63,40,6465.21,11192.82,84954.8,40,2534.07,238233.05,1535.33,49711.37,1382.71,177.29,19361.33,27257.71,100.18,7620.58,462.44,306.41,1175.45,231377.91,5271.85,271.42,2218.02,1779.44,117.38,412.15,971.45,663.5599999999999,8483.23,6753.58,107.49,418.14,844.03,423.95,598,153,134390,106.38,3166.74,10746.09,15194.31,4345.41,81538.03999999999,156196.97,4260.12,5674.94,1126.44,10621.46,150791.88,194.95,2803.91,5930.25,30304.96,695.49,3041.02,1537.96,9432.209999999999,201.79,2951.21,2276.52,161829.67,2493.08,510.02,516.3099999999999,380.65,101.33,194.95,258.42,629.4,162.64,657.45,1510.75,887.98,1106.16,390.87,1432.45,17247.63,522.87,2838.88,1036.48,185.15,194.68,305.1,23498.38,48147.67,2472.66,1950.75,364.33,3318.12,9437.959999999999,101.65,772.28,364.33,130.1,44563.27,11480.55,2176.37,515.83,14976.57,2771.28,8175.76,1107.09,2346.05,2660.64,331.03,1793.12,9192.18,8883.23,260.95,1181.75,5997.04,5214.95,1674.04,2501.48,10610.45,1811.2,9576.33,4522.73,1162.77,597,8095.63,164.59,2435.32,24722.11,15631.98,226.65,2507.89,447.16,13178.49,8818.84,74960.58,155.83,938.97,177,2943.89,26396,1260.06,1941.46,1414.59,40,343.39,6141.8,272.01,9187.82,327.27,1157.41,695.12,343.39,6141.8,408.69,154.65,40,40,40,8837.65,2472.28,294.19,2672.03,1208.7,150.03,40,191.73,240.86,109.64,40,497.75,898.1900000000001,327.42,40,2854.56,368.95,888.6900000000001,747.55,4263.22,272.36,13209.18,2258.55,1933.95,101.73,1460.38,2743.81,153.86,215.39,514.27,2279.05,323.29,1737.29,835.61,12550.17,1295.63,5551.68,691.92,25794.92,167232.92,165.87,8461.110000000001,14824.89,64235.77,287964.26,220.51,7253.88,157328.72,35762.06,12837.44,1140.35,255178.14,91772.21000000001,153659.2,161926.92,1196.02,9732.26,3338.01,189322.64,741.14,1237,4292.02,33471.51,5661.4,527.92,906.1900000000001,395.64,6147.91,3755.73,7612.05,268.44,610.27,6241.75,666.05,633.01,2808.77,40,40,40,40,40,40,40,40,40,172.85,40,40,40,40,40,40,40,40,40,40,40,40,40],"title":["Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Import Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity","Export Quantity"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":"bmi_usd_price","color":{"background":"white","border":"#2B7CE9"},"font":{"color":"white"},"shadow":true},"manipulation":{"enabled":false},"edges":{"color":{"color":"#A5ABB6","highlight":"#FF4F09"},"smooth":false},"interaction":{"navigationButtons":true,"zoomSpeed":1},"layout":{"randomSeed":123}},"groups":["Asia","South America","Africa","Europe","North America","Oceania"],"width":"100%","height":"400px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":{"render":[{"code":"\n    function(el, x) {\n      el.style.backgroundColor = 'black';\n    }\n  ","data":null}]}}</script>
</div>
</div>
<section id="network-centrality-and-community-clustering" class="level2">
<h2 class="anchored" data-anchor-id="network-centrality-and-community-clustering">3.1 Network Centrality and Community Clustering</h2>
<p>For our scope of the project, we will select 50+ countries with (1) significant trade activities and (2) complete data together with BMI(Index). A <em>Trade Connectivity Index (TCI)</em> will be calculated for each edge in the network will be calculated as follows:</p>
<p><img src="images/TCI.png" class="img-fluid" width="305"></p>
<p><strong>Edge Weight Formula: Trade Connectivity Index (TCI)</strong></p>
<p>This formula reflects the proportion of beef trade (exports and imports) in relation to the total trade volume between two countries. It highlights the significance of beef trade in the bilateral trade relationship, making it particularly relevant for analysing the trade networks with respect to the Big Mac Index. Hence, this will be applied to our network edges.</p>
<ul>
<li><p><strong>Beef Exports Value</strong> and <strong>Beef Imports Value</strong> refer to the value of beef traded between the two countries forming an edge in the network.</p></li>
<li><p><strong>Total Exports Value</strong> and <strong>Total Imports Value</strong> encompass the total trade volume between these countries, providing a base to understand the relative importance of beef trade.</p></li>
</ul>
<p><strong>Node Attributes</strong></p>
<p>For the nodes, you can maintain attributes that reflect each country’s economic and demographic scale, as well as its relevance to the Big Mac Index:</p>
<ul>
<li><p><strong>BMI Index</strong>: Directly use the Big Mac Index as a node attribute to represent the pricing level of a Big Mac, serving as a proxy for purchasing power parity.</p></li>
<li><p><strong>Trade Value</strong>: This could be represented by either Total Exports or Total Imports to reflect the country’s engagement in global trade. Alternatively, you might use a composite measure such as GDP to reflect overall economic size and capacity.</p></li>
</ul>
<p>We will compute the centrality and community clusters to determine their community clusters</p>
<p>In our exploration of global trade dynamics, specifically through the lens of beef exports and imports, we aim to uncover insights into the Big Mac Index, a whimsical gauge of purchasing power parity devised by The Economist. Analyzing beef trade patterns grants us a direct line of inquiry into the pricing mechanisms of the Big Mac, considering beef’s pivotal role in its composition. This focus allows us to parse the supply chain intricacies and market conditions that dictate the variability in Big Mac prices across different regions. The rationale behind this targeted analysis is to use beef trade as a tangible metric for understanding broader economic trends and pricing pressures that ultimately influence consumer goods’ costs.</p>
<p>To navigate this complex interplay, we’ve adopted a formula integrating critical trade data and economic indicators to model their relationship with the Big Mac Index. This formula captures the essence of trade balance, economic scale (granular and macro at the same time), and the specific impact of beef trade. It correlates net exports relative to GDP per capita with the proportions of beef exports and imports within total trade, providing a nuanced perspective on how trade dynamics influence market conditions and, by extension, Big Mac prices.</p>
</section>
<section id="computing-centrality" class="level2">
<h2 class="anchored" data-anchor-id="computing-centrality">3.2 Computing Centrality</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>bmi2021_graph <span class="ot">&lt;-</span> igraph<span class="sc">::</span><span class="fu">set_vertex_attr</span>(bmi2021_graph, <span class="st">"betweenness"</span>, <span class="at">value =</span> igraph<span class="sc">::</span><span class="fu">betweenness</span>(bmi2021_graph))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(bmi2021_graph, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> Value), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> betweenness), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">hjust =</span> <span class="fl">0.6</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.8</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent))</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Degree Centrality</strong> Degree centrality measures the number of edges connected to a node. In directed networks, you can distinguish between in-degree and out-degree.</p>
<p>Degree centrality is a measure used in network analysis to quantify the importance or influence of a particular node within a network. It is based on the number of connections, or edges, that a node has to other nodes. The central concept behind degree centrality is simple: nodes with more connections are considered more central and potentially more influential within the network.</p>
<p>There are two types of degree centrality:</p>
<p>In-Degree Centrality: This measures the number of incoming connections to a node. It can be particularly relevant in directed networks where the direction of the connection matters. A high in-degree centrality indicates that a node is a major target within the network, receiving many connections from other nodes. This can signify a node of high interest or popularity.</p>
<p>Out-Degree Centrality: This measures the number of outgoing connections from a node. Like in-degree centrality, it is applicable in directed networks. A high out-degree centrality signifies that a node actively reaches out to many other nodes, which can indicate a source or distributor of information, goods, or influence within the network</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Degree centrality is a straightforward but powerful concept in network analysis, useful for identifying key nodes that might play critical roles in the dissemination of information, disease transmission, social network influence, and more within a network.</p>
<p><strong>Eigenvector Centrality</strong> Eigenvector centrality measures a node’s influence based on the principle that connections to high-scoring nodes contribute more to the score of the node in question.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
0.0000108 0.0010364 0.0061979 0.0611162 0.0231699 1.0000000 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1068683 1.0000000 0.6944934 0.3322083 0.2881434 0.1124052</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Eigenvector centrality is useful for identifying influential nodes in a network where connections to high-scoring nodes contribute more to the score of the node than equal connections to low-scoring nodes.</p>
<p><strong>Closeness centrality</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Putting the results in a dataframe.</p>
<p>In the Shiny App, we will allow the audience to explore these statistical methods to gain insights from the networks.</p>
<table class="table">
<colgroup>
<col style="width: 24%">
<col style="width: 20%">
<col style="width: 30%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Betweenness</th>
<th>Degree</th>
<th>EigenVector</th>
<th>Closeness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Nodes like the United States and Brazil have high betweenness centrality, suggesting that they act as significant connectors or bridges within the network, <strong>potentially controlling the flow of trade.</strong></td>
<td>Nodes such as the United States and Brazil have high degrees, meaning they have numerous trade connections, possibly making them <strong>central hubs in the beef trade network.</strong></td>
<td>The eigenvector centrality considers not just the number but the quality of connections. Nodes with high eigenvector centrality, like the <strong>United States and Australia, are connected to other well-connected nodes, hinting at influential trade cliques.</strong></td>
<td>High closeness centrality for nodes like the United States and South Africa suggests that they can quickly interact or trade with all other nodes, indicating efficiency in their trade operations.</td>
</tr>
<tr class="even">
<td>Some countries much higher centrality, which could mean <strong>the trade network relies heavily on these nodes</strong>, possibly creating vulnerability to disruptions.</td>
<td>Degree centrality can suggest potential market influence, with highly connected nodes being able to leverage their position for competitive advantage.</td>
<td>This measure reflects the potential for a node to access and influence the broader network through its connections.</td>
<td>Closeness centrality offers insight <strong>into the speed at which a country</strong> can react to supply and demand changes across the global network</td>
</tr>
<tr class="odd">
<td>Countries with lower betweenness centrality might have more <strong>direct trade links or may not be critical transit points within the network.</strong></td>
<td>A spread of degree centrality across the network would indicate a democratized trading environment, but a concentration suggests a few key players dominate.</td>
<td>Low eigenvector centrality could indicate peripheral or less influential roles within the trading network, possibly <strong>representing newer or more specialized markets</strong>.</td>
<td>Low closeness centrality might point to <strong>potential delays in trade flows or inefficiencies,</strong> possibly due to geographical or logistical factor</td>
</tr>
</tbody>
</table>
<p>:::callout: Summary of Insights 1. Network Roles and Big Mac Pricing:</p>
<p>Countries central in the beef trade network, indicated by high betweenness or degree centrality, may have more stable and competitive beef pricing due to their numerous trade links, which could affect their local Big Mac prices. The presence of key influencers, as suggested by eigenvector centrality, could indicate the potential for price setting or market influence, which can trickle down to the pricing of beef and related products like the Big Mac.</p>
<ol start="2" type="1">
<li>Trade Efficiency and Cost:</li>
</ol>
<p>Closeness centrality can signal efficient trade practices and the potential for rapid adjustment to market changes, which could lead to more competitive and stable pricing for beef, affecting the Big Mac Index. Any delays or inefficiencies in beef imports could increase costs for local producers, potentially raising Big Mac prices in countries with lower closeness centrality.</p>
<ol start="3" type="1">
<li>Cluster Analysis and Market Groupings:</li>
</ol>
<p>Clustering helps identify groups of countries with similar trade patterns, which can show regional variations in Big Mac prices due to similarities in trade dynamics and economic profiles. Understanding these clusters can provide insights into regional pricing strategies for the Big Mac and indicate how economic or trade changes in one country might impact others within the same cluster. :::</p>
</section>
<section id="computing-community-indices" class="level2">
<h2 class="anchored" data-anchor-id="computing-community-indices">3.3 Computing Community Indices</h2>
<p>Tidygraph package inherits many of the community detection algorithms imbedded into igraph We will utilise 3 community detection algo: (1) Leading eigenvector (group_leading_eigen), (2) Walktrap and (3) Spinglass (group_spinglass).Some community algorithms are designed to take into account direction or weight, while others ignore it.</p>
<p><strong>group_leading Eigenvector</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> bmi2021_graph <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">community =</span> <span class="fu">as.factor</span>(<span class="fu">group_leading_eigen</span>(<span class="at">weights =</span> Value))) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> Value), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>communities <span class="ot">&lt;-</span> <span class="fu">cluster_leading_eigen</span>(bmi2021_graph, <span class="at">weights =</span> <span class="fu">E</span>(bmi2021_graph)<span class="sc">$</span>Value)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add community info to the nodes dataframe</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>community <span class="ot">&lt;-</span> communities<span class="sc">$</span>membership</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'id' column for joining and 'label' for visNetwork node labels</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>label <span class="ot">&lt;-</span> bmi_node_2021<span class="sc">$</span>country</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>community <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(bmi_node_2021<span class="sc">$</span>community)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>num_communities <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(bmi_node_2021<span class="sc">$</span>community))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a color for each community</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Use colorRampPalette to create more colors if needed</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>color_palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="fu">min</span>(<span class="dv">9</span>, num_communities), <span class="at">name =</span> <span class="st">"Set1"</span>))</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>community_colors <span class="ot">&lt;-</span> <span class="fu">color_palette</span>(num_communities)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Map community IDs to colors</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>color_mapping <span class="ot">&lt;-</span> <span class="fu">setNames</span>(community_colors, <span class="fu">levels</span>(bmi_node_2021<span class="sc">$</span>community))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>color <span class="ot">&lt;-</span> color_mapping[bmi_node_2021<span class="sc">$</span>community]</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>bmi_edges_2021_aggregated <span class="ot">&lt;-</span> bmi_edges_2021 <span class="sc">%&gt;%</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bmi_node_2021, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Origin"</span> <span class="ot">=</span> <span class="st">"country"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bmi_node_2021, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Partners"</span> <span class="ot">=</span> <span class="st">"country"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(from, to) <span class="sc">%&gt;%</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(Value &gt; 1) %&gt;%</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>label <span class="ot">&lt;-</span> bmi_node_2021<span class="sc">$</span>country</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the network visualization</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(<span class="at">nodes =</span> bmi_node_2021, <span class="at">edges =</span> bmi_edges_2021_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_nicely"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"community"</span>), <span class="at">shape =</span> <span class="st">"dot"</span>, <span class="at">scaling =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">35</span>, <span class="at">face =</span> <span class="st">"arial"</span>, <span class="at">color =</span> <span class="st">"#000000"</span>, <span class="at">bold =</span> <span class="st">"true"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-08be4e8528e68a5cec62" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-08be4e8528e68a5cec62">{"x":{"nodes":{"id":[46,1,27,40,53,3,30,20,15,37,11,19,42,28,22,6,17,45,16,18,8,5,39,52,51,2,32,47,36,4,29,23,14,34,21,50,24,48,9,31,35,10,38,12,43,49,44,41,26,7,25,33,13],"country":["Lebanon","Argentina","Turkey","Ghana","Ukraine","Brazil","Uruguay","Russia","Mexico","Egypt","Hungary","Poland","India","United States","South Africa","Chile","Peru","Kuwait","New Zealand","Philippines","Czech Republic","Canada","Germany","Spain","Saudi Arabia","Australia","Austria","Netherlands","Croatia","United Kingdom","United Arab Emirates","South Korea","Malaysia","Belgium","Singapore","Qatar","Sweden","Oman","Denmark","Viet Nam","Costa Rica","Hong Kong","France","Indonesia","Israel","Portugal","Jordan","Greece","Thailand","China","Switzerland","Bahrain","Japan"],"year":[2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021],"bmi_usd_price":[5.08,3.75,2.01,2.16,2.2,3.98,4.8,1.81,2.68,2.72,3.03,3.51,2.59,4.89,2.16,4.09,3.29,3.79,4.87,2.95,4.12,5.29,5.16,5.16,3.73,4.98,5.16,5.16,3.69,4.44,4.02,4.1,2.47,5.16,4.43,3.57,6.37,2.86,4.9,2.86,3.83,2.64,5.16,2.41,5.35,5.16,3.24,5.16,4.25,3.46,7.29,3.98,3.74],"export_usd":[4229976.47,65386155.68,330886757,16768275.19,65870275.51,259319343.5,9541020.289999999,369704970.1,510446816.1,40701703.94,135105889.8,347416542.2,394812673.4,3291674759,119580111.1,98636407.29000001,50828364.65,63129693.95,49928447.97,160694229.1,187704391.6,529223309.5,1635599574,391558519.5,286467258.6,279420552.8,194703246,696873257.2,21827948.96,1010705115,425159796.5,599607208.2,269840936.9,386354055.2,366827604.7,87203291.19,168148413.6,44590926.52,115774658.8,335792597.8,14345395.57,750206748.8,585148036.6,202125597.3,60159734,75242766.89,9356550,94488554.63,254099887.4,2419607092,506450948,18198973.8,704318189.1],"import_usd":[13856703.73,79164554.81999999,213611436.7,10439795.45,69962816.3,313645918.4,10320349.45,497599095.7,529171620,73781228.87,134275134.1,297597905,570402004.5,1703893335,160980172.4,100664759.2,65199125.07,31885707.16,46316762.07,108774557.2,194826922,515729589.9,1424674986,426059816.7,152695088.7,374899439.4,210703246,623369106.9,33735256.5,411203957.2,347528997.7,731208978,417142772.7,393654055.2,297256085.2,27985403.21,179311040.9,30994759.15,112597864.1,330752261.4,18428113.84,93455326.22,7148423141,264351623.6,92158602,98337110.28,21542434.57,154570056.6,320261003.2,3383435785,388342418.5,14135237.38,850187993.8],"net_export":[-9626727.26,-13778399.14,117275320.3,6328479.74,-4092540.79,-54326574.91,-779329.16,-127894125.7,-18724803.92,-33079524.93,830755.77,49818637.24,-175589331.1,1587781425,-41400061.33,-2028351.95,-14370760.42,31243986.79,3611685.9,51919671.9,-7122530.41,13493719.53,210924587.7,-34501297.25,133772169.9,-95478886.56999999,-16000000,73504150.31,-11907307.54,599501158,77630798.8,-131601769.8,-147301835.8,-7300000,69571519.51000001,59217887.98,-11162627.24,13596167.37,3176794.7,5040336.46,-4082718.27,656751422.6,-6563275104,-62226026.25,-31998868,-23094343.39,-12185884.57,-60081501.98,-66161115.83,-963828693.3,118108529.6,4063736.42,-145869804.8],"total_trade":[18086680.2,144550710.5,544498193.7,27208070.64,135833091.8,572965261.9,19861369.74,867304065.8,1039618436,114482932.8,269381023.9,645014447.2,965214677.9,4995568094,280560283.5,199301166.5,116027489.7,95015401.11,96245210.04000001,269468786.3,382531313.6,1044952899,3060274560,817618336.2,439162347.3,654319992.2,405406492,1320242364,55563205.46,1421909072,772688794.2,1330816186,686983709.6,780008110.4,664083689.9,115188694.4,347459454.5,75585685.67,228372522.9,666544859.2,32773509.41,843662075,7733571178,466477220.9,152318336,173579877.2,30898984.57,249058611.2,574360890.6,5803042877,894793366.5,32334211.18,1554506183],"gdp_per_capita":[4136.2,10650.9,9743.200000000001,2363.3,4835.6,7696.8,17313.2,12532.1,10359.1,3698.8,18753,18050.3,2256.6,70219.5,7073.6,16240.6,6635.5,32187,49996.4,3460.5,26822.5,52358.6,51203.6,30103.5,23185.9,60697.2,53637.7,57767.9,17685.3,46869.8,44315.6,35142.3,11134.6,51274,77710.10000000001,66838.39999999999,61417.7,19509.5,69268.7,3756.5,12472.4,49764.8,43659,4334.2,52170.7,24567.5,4103.3,20192.6,7060.9,12617.5,93446.39999999999,26593,39827.1],"inflation":[154.8,48.4,19.6,10,9.4,8.300000000000001,7.8,6.7,5.7,5.2,5.1,5.1,4.9,4.7,4.6,4.5,4.3,4,3.9,3.9,3.8,3.4,3.1,3.1,3.1,2.9,2.8,2.7,2.6,2.5,2.5,2.5,2.5,2.4,2.3,2.3,2.2,2.2,1.9,1.8,1.7,1.6,1.6,1.6,1.5,1.3,1.3,1.2,1.2,1,0.6,0.6,-0.2],"continent":["Asia","South America","Asia","Africa","Europe","South America","South America","Europe","North America","Africa","Europe","Europe","Asia","North America","Africa","South America","South America","Asia","Oceania","Asia","Europe","North America","Europe","Europe","Asia","Oceania","Europe","Europe","Europe","Europe","Asia","Asia","Asia","Europe","Asia","Asia","Europe","Asia","Europe","Asia","North America","Asia","Europe","Asia","Asia","Europe","Asia","Europe","Asia","Asia","Europe","Asia","Asia"],"LON":[35.888,-65.167,35.179,-1.207,31.388,-53.089,-56.012,96.68899999999999,-102.535,29.872,19.134,19.401,78.5,-98.60599999999999,23.121,-69.43300000000001,-75.55200000000001,47.376,172.235,122.466,15.338,-109.433,9.851000000000001,-3.649,44.585,136.189,14.912,5.389,16.693,-1.6,54.163,128.103,102.195,4.664,103.808,51.191,15.27,57.407,9.263999999999999,105.314,-83.946,114.129,2.55,114.252,34.851,-8.058,36.319,21.766,100.844,106.514,7.908,50.562,139.068],"LAT":[33.92,-35.377,39.061,7.96,49.016,-10.772,-32.8,61.988,23.951,26.494,47.07,52.125,21,39.622,-30.558,-23.389,-9.326000000000001,29.476,-42.634,11.118,49.743,59.081,51.11,40.227,24.023,-24.973,47.683,52.077,45.723,53,23.549,36.504,4.201,50.643,1.351,25.316,62.011,21.656,56.058,21.491,9.971,22.423,46.565,-0.976,31.026,40.309,30.703,39.666,15.7,33.42,46.861,26.019,36.491],"community":["1","3","11","11","11","2","2","4","5","2","2","2","12","6","6","5","2","2","2","2","2","13","12","7","9","8","8","6","5","5","5","2","2","2","2","2","10","13","13","7","7","7","8","8","11","11","11","11","6","6","6","6","6"],"label":["Lebanon","Argentina","Turkey","Ghana","Ukraine","Brazil","Uruguay","Russia","Mexico","Egypt","Hungary","Poland","India","United States","South Africa","Chile","Peru","Kuwait","New Zealand","Philippines","Czech Republic","Canada","Germany","Spain","Saudi Arabia","Australia","Austria","Netherlands","Croatia","United Kingdom","United Arab Emirates","South Korea","Malaysia","Belgium","Singapore","Qatar","Sweden","Oman","Denmark","Viet Nam","Costa Rica","Hong Kong","France","Indonesia","Israel","Portugal","Jordan","Greece","Thailand","China","Switzerland","Bahrain","Japan"],"color":["#E41A1C","#3E8E93","#DB728C","#DB728C","#DB728C","#705C83","#705C83","#4DAF4A","#7E6E85","#705C83","#705C83","#705C83","#D789B2","#BA5E6C","#BA5E6C","#7E6E85","#705C83","#705C83","#705C83","#705C83","#705C83","#999999","#D789B2","#FF7F00","#E1C62F","#FFD421","#FFD421","#BA5E6C","#7E6E85","#7E6E85","#7E6E85","#705C83","#705C83","#705C83","#705C83","#705C83","#A65628","#999999","#999999","#FF7F00","#FF7F00","#FF7F00","#FFD421","#FFD421","#DB728C","#DB728C","#DB728C","#DB728C","#BA5E6C","#BA5E6C","#BA5E6C","#BA5E6C","#BA5E6C"],"x":[-0.9635782847182827,-0.8184894185148122,0.7582978213306024,0.6596845743713164,0.5156256861717237,-0.4508160984418934,0.5257229882655905,0.006656532849770302,0.3445440007108804,-0.08498472196748275,0.1403478780578387,0.002148638018742544,0.7302372788825213,0.5708055309265385,0.2679274565448455,-0.1789767846008908,0.06876703377803617,-0.9371673732121816,0.4307517757324884,-0.2197897364326721,0.2708250681927478,-0.04408403993863708,0.4397295237832906,0.6441546264335529,0.7305276142868158,-0.6638328561571191,-0.08326564300084693,-0.9934462405971356,-0.1004365198210022,-0.8487506768146502,0.6632495975433688,0.4794580879742372,0.3333054812760727,0.02553041135983913,0.00421142212109693,0.7336334516630862,0.6337117144735811,-1,0.1140286945926601,0.3145454047087821,-0.04668812983401915,-0.0169234478197724,0.06123401336110912,0.3242683500870907,1,0.7030719802244161,0.823977465062395,0.7873388041199161,0.8476441643386057,0.1993867373740648,0.6932656648709272,-0.3488179453346018,0.551906436182195],"y":[0.1501803474057757,-0.2159362807575164,-0.07929684587564356,-1,0.6449267980376689,0.1739471603665914,0.8395864951775922,0.1502275050422806,0.4644015016383418,-0.1294384052726161,-0.3447380042105961,0.7414432067452379,-0.9679056456494117,0.369510476929491,-0.5099534089123843,0.3059702832175129,0.6008541767509237,0.4331039089157755,0.5430512094249902,0.5661632975399529,0.05513042236166554,0.1284978204266189,-0.5069809760653459,0.5857766267023394,0.3701235022096159,-0.03847530985899528,0.6602282711999059,0.3583647678587514,0.9228444228818897,0.2697745779296208,0.304615585049768,-0.1147580274149701,0.3079211244983409,0.9824104579353667,-0.1951928930105689,0.4709794968179424,-0.6736445392721517,0.2482888728547252,0.4383220320805863,0.7112309579677421,1,0.2968791573039986,-0.4514414114409495,-0.2866791384766934,-0.2517159245573941,0.5547183942854415,0.05393593756051351,-0.8950878875821594,-0.1817789025938186,-0.05675676769168381,-0.3605603774285463,0.6882808312596347,-0.1392564723912205]},"edges":{"from":[1,2,3,3,3,4,4,4,4,5,5,5,6,6,7,7,7,7,8,8,9,9,9,9,9,10,10,10,10,10,11,11,12,12,13,13,13,13,13,13,14,15,16,16,16,16,17,17,18,18,19,19,19,19,20,20,21,21,22,22,23,23,24,24,24,24,26,26,27,28,28,28,28,28,29,30,31,32,33,34,35,36,37,38,39,40,41,43,44,45,46,47,48,49,50,51,52,53],"to":[2,3,4,5,6,45,46,47,48,7,8,9,9,10,10,11,12,13,13,14,14,15,16,17,19,17,18,19,20,21,21,22,22,23,23,24,25,26,27,28,28,28,28,29,30,31,31,32,32,33,9,34,35,36,9,37,37,38,38,39,28,39,39,40,41,42,43,44,44,49,50,51,52,53,44,53,53,17,18,19,19,19,21,21,22,42,42,26,27,4,4,4,4,28,28,28,28,28],"Value":[2,18,18,17,7,5,1,21,3,13,3,11,3,9,3,5,6,2,13,2,4,9,18,2,1,2,8,12,4,3,4,7,5,5,2,1,5,9,1,2,10,7,1,6,19,7,3,2,11,5,5,13,3,3,9,1,6,8,5,16,2,1,2,3,2,6,5,2,3,7,5,6,15,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"physics":false,"id":{"colour":"community"},"shape":"dot","font":{"size":35,"face":"arial","color":"#000000","bold":"true"},"scaling":{"label":{"enabled":true}}},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>WalkTrap</strong> The Walktrap algorithm is another method for detecting communities in graphs. It attempts to find densely connected subgraphs (communities) in a graph based on random walks. The idea is that short random walks tend to stay in the same community.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-d562611791debb1caf75" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d562611791debb1caf75">{"x":{"nodes":{"id":[46,1,27,40,53,3,30,20,15,37,11,19,42,28,22,6,17,45,16,18,8,5,39,52,51,2,32,47,36,4,29,23,14,34,21,50,24,48,9,31,35,10,38,12,43,49,44,41,26,7,25,33,13],"country":["Lebanon","Argentina","Turkey","Ghana","Ukraine","Brazil","Uruguay","Russia","Mexico","Egypt","Hungary","Poland","India","United States","South Africa","Chile","Peru","Kuwait","New Zealand","Philippines","Czech Republic","Canada","Germany","Spain","Saudi Arabia","Australia","Austria","Netherlands","Croatia","United Kingdom","United Arab Emirates","South Korea","Malaysia","Belgium","Singapore","Qatar","Sweden","Oman","Denmark","Viet Nam","Costa Rica","Hong Kong","France","Indonesia","Israel","Portugal","Jordan","Greece","Thailand","China","Switzerland","Bahrain","Japan"],"year":[2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021],"bmi_usd_price":[5.08,3.75,2.01,2.16,2.2,3.98,4.8,1.81,2.68,2.72,3.03,3.51,2.59,4.89,2.16,4.09,3.29,3.79,4.87,2.95,4.12,5.29,5.16,5.16,3.73,4.98,5.16,5.16,3.69,4.44,4.02,4.1,2.47,5.16,4.43,3.57,6.37,2.86,4.9,2.86,3.83,2.64,5.16,2.41,5.35,5.16,3.24,5.16,4.25,3.46,7.29,3.98,3.74],"export_usd":[4229976.47,65386155.68,330886757,16768275.19,65870275.51,259319343.5,9541020.289999999,369704970.1,510446816.1,40701703.94,135105889.8,347416542.2,394812673.4,3291674759,119580111.1,98636407.29000001,50828364.65,63129693.95,49928447.97,160694229.1,187704391.6,529223309.5,1635599574,391558519.5,286467258.6,279420552.8,194703246,696873257.2,21827948.96,1010705115,425159796.5,599607208.2,269840936.9,386354055.2,366827604.7,87203291.19,168148413.6,44590926.52,115774658.8,335792597.8,14345395.57,750206748.8,585148036.6,202125597.3,60159734,75242766.89,9356550,94488554.63,254099887.4,2419607092,506450948,18198973.8,704318189.1],"import_usd":[13856703.73,79164554.81999999,213611436.7,10439795.45,69962816.3,313645918.4,10320349.45,497599095.7,529171620,73781228.87,134275134.1,297597905,570402004.5,1703893335,160980172.4,100664759.2,65199125.07,31885707.16,46316762.07,108774557.2,194826922,515729589.9,1424674986,426059816.7,152695088.7,374899439.4,210703246,623369106.9,33735256.5,411203957.2,347528997.7,731208978,417142772.7,393654055.2,297256085.2,27985403.21,179311040.9,30994759.15,112597864.1,330752261.4,18428113.84,93455326.22,7148423141,264351623.6,92158602,98337110.28,21542434.57,154570056.6,320261003.2,3383435785,388342418.5,14135237.38,850187993.8],"net_export":[-9626727.26,-13778399.14,117275320.3,6328479.74,-4092540.79,-54326574.91,-779329.16,-127894125.7,-18724803.92,-33079524.93,830755.77,49818637.24,-175589331.1,1587781425,-41400061.33,-2028351.95,-14370760.42,31243986.79,3611685.9,51919671.9,-7122530.41,13493719.53,210924587.7,-34501297.25,133772169.9,-95478886.56999999,-16000000,73504150.31,-11907307.54,599501158,77630798.8,-131601769.8,-147301835.8,-7300000,69571519.51000001,59217887.98,-11162627.24,13596167.37,3176794.7,5040336.46,-4082718.27,656751422.6,-6563275104,-62226026.25,-31998868,-23094343.39,-12185884.57,-60081501.98,-66161115.83,-963828693.3,118108529.6,4063736.42,-145869804.8],"total_trade":[18086680.2,144550710.5,544498193.7,27208070.64,135833091.8,572965261.9,19861369.74,867304065.8,1039618436,114482932.8,269381023.9,645014447.2,965214677.9,4995568094,280560283.5,199301166.5,116027489.7,95015401.11,96245210.04000001,269468786.3,382531313.6,1044952899,3060274560,817618336.2,439162347.3,654319992.2,405406492,1320242364,55563205.46,1421909072,772688794.2,1330816186,686983709.6,780008110.4,664083689.9,115188694.4,347459454.5,75585685.67,228372522.9,666544859.2,32773509.41,843662075,7733571178,466477220.9,152318336,173579877.2,30898984.57,249058611.2,574360890.6,5803042877,894793366.5,32334211.18,1554506183],"gdp_per_capita":[4136.2,10650.9,9743.200000000001,2363.3,4835.6,7696.8,17313.2,12532.1,10359.1,3698.8,18753,18050.3,2256.6,70219.5,7073.6,16240.6,6635.5,32187,49996.4,3460.5,26822.5,52358.6,51203.6,30103.5,23185.9,60697.2,53637.7,57767.9,17685.3,46869.8,44315.6,35142.3,11134.6,51274,77710.10000000001,66838.39999999999,61417.7,19509.5,69268.7,3756.5,12472.4,49764.8,43659,4334.2,52170.7,24567.5,4103.3,20192.6,7060.9,12617.5,93446.39999999999,26593,39827.1],"inflation":[154.8,48.4,19.6,10,9.4,8.300000000000001,7.8,6.7,5.7,5.2,5.1,5.1,4.9,4.7,4.6,4.5,4.3,4,3.9,3.9,3.8,3.4,3.1,3.1,3.1,2.9,2.8,2.7,2.6,2.5,2.5,2.5,2.5,2.4,2.3,2.3,2.2,2.2,1.9,1.8,1.7,1.6,1.6,1.6,1.5,1.3,1.3,1.2,1.2,1,0.6,0.6,-0.2],"continent":["Asia","South America","Asia","Africa","Europe","South America","South America","Europe","North America","Africa","Europe","Europe","Asia","North America","Africa","South America","South America","Asia","Oceania","Asia","Europe","North America","Europe","Europe","Asia","Oceania","Europe","Europe","Europe","Europe","Asia","Asia","Asia","Europe","Asia","Asia","Europe","Asia","Europe","Asia","North America","Asia","Europe","Asia","Asia","Europe","Asia","Europe","Asia","Asia","Europe","Asia","Asia"],"LON":[35.888,-65.167,35.179,-1.207,31.388,-53.089,-56.012,96.68899999999999,-102.535,29.872,19.134,19.401,78.5,-98.60599999999999,23.121,-69.43300000000001,-75.55200000000001,47.376,172.235,122.466,15.338,-109.433,9.851000000000001,-3.649,44.585,136.189,14.912,5.389,16.693,-1.6,54.163,128.103,102.195,4.664,103.808,51.191,15.27,57.407,9.263999999999999,105.314,-83.946,114.129,2.55,114.252,34.851,-8.058,36.319,21.766,100.844,106.514,7.908,50.562,139.068],"LAT":[33.92,-35.377,39.061,7.96,49.016,-10.772,-32.8,61.988,23.951,26.494,47.07,52.125,21,39.622,-30.558,-23.389,-9.326000000000001,29.476,-42.634,11.118,49.743,59.081,51.11,40.227,24.023,-24.973,47.683,52.077,45.723,53,23.549,36.504,4.201,50.643,1.351,25.316,62.011,21.656,56.058,21.491,9.971,22.423,46.565,-0.976,31.026,40.309,30.703,39.666,15.7,33.42,46.861,26.019,36.491],"community":["10","8","8","8","4","4","4","4","4","4","4","4","5","7","7","3","4","4","6","4","1","2","5","5","5","5","11","7","3","3","3","4","4","6","6","6","1","2","2","9","9","9","5","12","8","8","8","8","7","7","7","7","7"],"label":["Lebanon","Argentina","Turkey","Ghana","Ukraine","Brazil","Uruguay","Russia","Mexico","Egypt","Hungary","Poland","India","United States","South Africa","Chile","Peru","Kuwait","New Zealand","Philippines","Czech Republic","Canada","Germany","Spain","Saudi Arabia","Australia","Austria","Netherlands","Croatia","United Kingdom","United Arab Emirates","South Korea","Malaysia","Belgium","Singapore","Qatar","Sweden","Oman","Denmark","Viet Nam","Costa Rica","Hong Kong","France","Indonesia","Israel","Portugal","Jordan","Greece","Thailand","China","Switzerland","Bahrain","Japan"],"color":["#D26D7A","#F6EF32","#F6EF32","#F6EF32","#5A9D5A","#5A9D5A","#5A9D5A","#5A9D5A","#5A9D5A","#5A9D5A","#5A9D5A","#5A9D5A","#91569A","#FFAD12","#FFAD12","#419486","#5A9D5A","#5A9D5A","#D96D3B","#5A9D5A","#E41A1C","#66628D","#91569A","#91569A","#91569A","#91569A","#DD87B4","#FFAD12","#419486","#419486","#419486","#5A9D5A","#5A9D5A","#D96D3B","#D96D3B","#D96D3B","#E41A1C","#66628D","#66628D","#B6742A","#B6742A","#B6742A","#91569A","#999999","#F6EF32","#F6EF32","#F6EF32","#F6EF32","#FFAD12","#FFAD12","#FFAD12","#FFAD12","#FFAD12"],"x":[0.8744035083325916,0.2496393670681989,0.7338680853157062,-0.02052888952630549,0.5248019794998637,0.3242381210651899,0.6998606649293326,-0.4406713613534914,0.2407722906608822,-0.7030066241058529,-0.3944121400793086,-0.3348641434834605,0.09595778785864129,0.45286699286798,-0.3568001095566418,-0.01551849651660664,-0.1949848998713234,0.694959878123931,0.4514402236959545,-0.7508617541509435,0.2240846635049476,0.1456797546594486,-0.1198446788705861,0.5078711196511632,0.6966551536875105,0.2930260951886667,-0.4801365879395614,0.9442379812988781,-0.5566865893734856,0.7150994113714499,0.8425296124786659,0.1370832483922166,0.171550050901758,-0.4789627415643466,-0.5850190233508998,0.6350833675874294,0.1236872846765216,0.8235887765217951,-0.03605200157525035,0.2577166377808544,-0.3634624192737568,-0.3510093742474945,-0.6254145526142904,-0.1415674235576297,1,0.6643696971347781,0.912245272393664,0.2147303547618706,0.8002104129791039,-0.06625038839256703,0.4415396534685425,-1,0.3459338675702188],"y":[0.939883496407528,0.9819960541413344,-0.4809278616182393,-0.9826819838394518,-0.01149831104423382,0.5260400737691728,0.104063565461461,0.05434793800845461,0.006621959155399981,-0.06766512017489834,-0.2992088129897653,0.3435036139027772,-1,-0.1910444910481914,-0.4844835745952762,0.3278331928506373,0.2063522843620538,0.9944715422361068,0.02794701162715696,0.2194317301086703,-0.1660569775604838,0.1260357262594745,-0.6003967126228609,-0.3088468609020467,-0.220244536289811,0.7850801236110334,0.2445681630887684,0.8894435902757212,0.4312496939999981,0.8506371990777992,-0.1549926065671472,-0.4231287103204782,-0.0521073085907976,0.4848258463704271,-0.1588040051567996,-0.2825968993585575,-0.7865005295913011,1,0.152963678537529,0.1462347371863058,0.5010484503289843,0.1046144798544106,-0.334351742592066,-0.3926696971329851,-0.680300539177362,-0.1434129402177416,-0.4078123908908826,-0.9938977182933073,-0.5764231865896302,-0.176229137043049,-0.6512123507680653,0.2647622696297267,-0.4464338912579977]},"edges":{"from":[1,2,3,3,3,4,4,4,4,5,5,5,6,6,7,7,7,7,8,8,9,9,9,9,9,10,10,10,10,10,11,11,12,12,13,13,13,13,13,13,14,15,16,16,16,16,17,17,18,18,19,19,19,19,20,20,21,21,22,22,23,23,24,24,24,24,26,26,27,28,28,28,28,28,29,30,31,32,33,34,35,36,37,38,39,40,41,43,44,45,46,47,48,49,50,51,52,53],"to":[2,3,4,5,6,45,46,47,48,7,8,9,9,10,10,11,12,13,13,14,14,15,16,17,19,17,18,19,20,21,21,22,22,23,23,24,25,26,27,28,28,28,28,29,30,31,31,32,32,33,9,34,35,36,9,37,37,38,38,39,28,39,39,40,41,42,43,44,44,49,50,51,52,53,44,53,53,17,18,19,19,19,21,21,22,42,42,26,27,4,4,4,4,28,28,28,28,28],"Value":[2,18,18,17,7,5,1,21,3,13,3,11,3,9,3,5,6,2,13,2,4,9,18,2,1,2,8,12,4,3,4,7,5,5,2,1,5,9,1,2,10,7,1,6,19,7,3,2,11,5,5,13,3,3,9,1,6,8,5,16,2,1,2,3,2,6,5,2,3,7,5,6,15,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"physics":false,"shape":"dot","label":"label","color":"color","font":{"size":35,"face":"arial","color":"#000000","bold":"true"},"scaling":{"label":{"enabled":true}}},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Spinglass</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> bmi2021_graph <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">community =</span> <span class="fu">as.factor</span>(<span class="fu">group_spinglass</span>(<span class="at">weights =</span> Value))) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> Value), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> community)) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Take-Home_Exercise04_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Spinglass community detection</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>communities_spinglass <span class="ot">&lt;-</span> <span class="fu">cluster_spinglass</span>(bmi2021_graph, <span class="at">weights =</span> <span class="fu">E</span>(bmi2021_graph)<span class="sc">$</span>weight)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add community info to the nodes dataframe</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>community <span class="ot">&lt;-</span> communities_spinglass<span class="sc">$</span>membership</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'id' column for joining and 'label' for visNetwork node labels</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>label <span class="ot">&lt;-</span> bmi_node_2021<span class="sc">$</span>country</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>community <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(bmi_node_2021<span class="sc">$</span>community)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>num_communities <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(bmi_node_2021<span class="sc">$</span>community))</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a color for each community</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Use colorRampPalette to create more colors if needed</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>color_palette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="fu">min</span>(<span class="dv">9</span>, num_communities), <span class="at">name =</span> <span class="st">"Set1"</span>))</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>community_colors <span class="ot">&lt;-</span> <span class="fu">color_palette</span>(num_communities)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Map community IDs to colors</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>color_mapping <span class="ot">&lt;-</span> <span class="fu">setNames</span>(community_colors, <span class="fu">levels</span>(bmi_node_2021<span class="sc">$</span>community))</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>color <span class="ot">&lt;-</span> color_mapping[bmi_node_2021<span class="sc">$</span>community]</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>bmi_edges_2021_aggregated <span class="ot">&lt;-</span> bmi_edges_2021 <span class="sc">%&gt;%</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bmi_node_2021, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Origin"</span> <span class="ot">=</span> <span class="st">"country"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bmi_node_2021, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Partners"</span> <span class="ot">=</span> <span class="st">"country"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(from, to) <span class="sc">%&gt;%</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(Value &gt; 1) %&gt;%</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>bmi_node_2021<span class="sc">$</span>label <span class="ot">&lt;-</span> bmi_node_2021<span class="sc">$</span>country</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the network visualization</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(<span class="at">nodes =</span> bmi_node_2021, <span class="at">edges =</span> bmi_edges_2021_aggregated) <span class="sc">%&gt;%</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_nicely"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"community"</span>), <span class="at">shape =</span> <span class="st">"dot"</span>, <span class="at">scaling =</span> <span class="fu">list</span>(<span class="at">label =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">35</span>, <span class="at">face =</span> <span class="st">"arial"</span>, <span class="at">color =</span> <span class="st">"#000000"</span>, <span class="at">bold =</span> <span class="st">"true"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-392cb0a71ce43b38c1d4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-392cb0a71ce43b38c1d4">{"x":{"nodes":{"id":[46,1,27,40,53,3,30,20,15,37,11,19,42,28,22,6,17,45,16,18,8,5,39,52,51,2,32,47,36,4,29,23,14,34,21,50,24,48,9,31,35,10,38,12,43,49,44,41,26,7,25,33,13],"country":["Lebanon","Argentina","Turkey","Ghana","Ukraine","Brazil","Uruguay","Russia","Mexico","Egypt","Hungary","Poland","India","United States","South Africa","Chile","Peru","Kuwait","New Zealand","Philippines","Czech Republic","Canada","Germany","Spain","Saudi Arabia","Australia","Austria","Netherlands","Croatia","United Kingdom","United Arab Emirates","South Korea","Malaysia","Belgium","Singapore","Qatar","Sweden","Oman","Denmark","Viet Nam","Costa Rica","Hong Kong","France","Indonesia","Israel","Portugal","Jordan","Greece","Thailand","China","Switzerland","Bahrain","Japan"],"year":[2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021,2021],"bmi_usd_price":[5.08,3.75,2.01,2.16,2.2,3.98,4.8,1.81,2.68,2.72,3.03,3.51,2.59,4.89,2.16,4.09,3.29,3.79,4.87,2.95,4.12,5.29,5.16,5.16,3.73,4.98,5.16,5.16,3.69,4.44,4.02,4.1,2.47,5.16,4.43,3.57,6.37,2.86,4.9,2.86,3.83,2.64,5.16,2.41,5.35,5.16,3.24,5.16,4.25,3.46,7.29,3.98,3.74],"export_usd":[4229976.47,65386155.68,330886757,16768275.19,65870275.51,259319343.5,9541020.289999999,369704970.1,510446816.1,40701703.94,135105889.8,347416542.2,394812673.4,3291674759,119580111.1,98636407.29000001,50828364.65,63129693.95,49928447.97,160694229.1,187704391.6,529223309.5,1635599574,391558519.5,286467258.6,279420552.8,194703246,696873257.2,21827948.96,1010705115,425159796.5,599607208.2,269840936.9,386354055.2,366827604.7,87203291.19,168148413.6,44590926.52,115774658.8,335792597.8,14345395.57,750206748.8,585148036.6,202125597.3,60159734,75242766.89,9356550,94488554.63,254099887.4,2419607092,506450948,18198973.8,704318189.1],"import_usd":[13856703.73,79164554.81999999,213611436.7,10439795.45,69962816.3,313645918.4,10320349.45,497599095.7,529171620,73781228.87,134275134.1,297597905,570402004.5,1703893335,160980172.4,100664759.2,65199125.07,31885707.16,46316762.07,108774557.2,194826922,515729589.9,1424674986,426059816.7,152695088.7,374899439.4,210703246,623369106.9,33735256.5,411203957.2,347528997.7,731208978,417142772.7,393654055.2,297256085.2,27985403.21,179311040.9,30994759.15,112597864.1,330752261.4,18428113.84,93455326.22,7148423141,264351623.6,92158602,98337110.28,21542434.57,154570056.6,320261003.2,3383435785,388342418.5,14135237.38,850187993.8],"net_export":[-9626727.26,-13778399.14,117275320.3,6328479.74,-4092540.79,-54326574.91,-779329.16,-127894125.7,-18724803.92,-33079524.93,830755.77,49818637.24,-175589331.1,1587781425,-41400061.33,-2028351.95,-14370760.42,31243986.79,3611685.9,51919671.9,-7122530.41,13493719.53,210924587.7,-34501297.25,133772169.9,-95478886.56999999,-16000000,73504150.31,-11907307.54,599501158,77630798.8,-131601769.8,-147301835.8,-7300000,69571519.51000001,59217887.98,-11162627.24,13596167.37,3176794.7,5040336.46,-4082718.27,656751422.6,-6563275104,-62226026.25,-31998868,-23094343.39,-12185884.57,-60081501.98,-66161115.83,-963828693.3,118108529.6,4063736.42,-145869804.8],"total_trade":[18086680.2,144550710.5,544498193.7,27208070.64,135833091.8,572965261.9,19861369.74,867304065.8,1039618436,114482932.8,269381023.9,645014447.2,965214677.9,4995568094,280560283.5,199301166.5,116027489.7,95015401.11,96245210.04000001,269468786.3,382531313.6,1044952899,3060274560,817618336.2,439162347.3,654319992.2,405406492,1320242364,55563205.46,1421909072,772688794.2,1330816186,686983709.6,780008110.4,664083689.9,115188694.4,347459454.5,75585685.67,228372522.9,666544859.2,32773509.41,843662075,7733571178,466477220.9,152318336,173579877.2,30898984.57,249058611.2,574360890.6,5803042877,894793366.5,32334211.18,1554506183],"gdp_per_capita":[4136.2,10650.9,9743.200000000001,2363.3,4835.6,7696.8,17313.2,12532.1,10359.1,3698.8,18753,18050.3,2256.6,70219.5,7073.6,16240.6,6635.5,32187,49996.4,3460.5,26822.5,52358.6,51203.6,30103.5,23185.9,60697.2,53637.7,57767.9,17685.3,46869.8,44315.6,35142.3,11134.6,51274,77710.10000000001,66838.39999999999,61417.7,19509.5,69268.7,3756.5,12472.4,49764.8,43659,4334.2,52170.7,24567.5,4103.3,20192.6,7060.9,12617.5,93446.39999999999,26593,39827.1],"inflation":[154.8,48.4,19.6,10,9.4,8.300000000000001,7.8,6.7,5.7,5.2,5.1,5.1,4.9,4.7,4.6,4.5,4.3,4,3.9,3.9,3.8,3.4,3.1,3.1,3.1,2.9,2.8,2.7,2.6,2.5,2.5,2.5,2.5,2.4,2.3,2.3,2.2,2.2,1.9,1.8,1.7,1.6,1.6,1.6,1.5,1.3,1.3,1.2,1.2,1,0.6,0.6,-0.2],"continent":["Asia","South America","Asia","Africa","Europe","South America","South America","Europe","North America","Africa","Europe","Europe","Asia","North America","Africa","South America","South America","Asia","Oceania","Asia","Europe","North America","Europe","Europe","Asia","Oceania","Europe","Europe","Europe","Europe","Asia","Asia","Asia","Europe","Asia","Asia","Europe","Asia","Europe","Asia","North America","Asia","Europe","Asia","Asia","Europe","Asia","Europe","Asia","Asia","Europe","Asia","Asia"],"LON":[35.888,-65.167,35.179,-1.207,31.388,-53.089,-56.012,96.68899999999999,-102.535,29.872,19.134,19.401,78.5,-98.60599999999999,23.121,-69.43300000000001,-75.55200000000001,47.376,172.235,122.466,15.338,-109.433,9.851000000000001,-3.649,44.585,136.189,14.912,5.389,16.693,-1.6,54.163,128.103,102.195,4.664,103.808,51.191,15.27,57.407,9.263999999999999,105.314,-83.946,114.129,2.55,114.252,34.851,-8.058,36.319,21.766,100.844,106.514,7.908,50.562,139.068],"LAT":[33.92,-35.377,39.061,7.96,49.016,-10.772,-32.8,61.988,23.951,26.494,47.07,52.125,21,39.622,-30.558,-23.389,-9.326000000000001,29.476,-42.634,11.118,49.743,59.081,51.11,40.227,24.023,-24.973,47.683,52.077,45.723,53,23.549,36.504,4.201,50.643,1.351,25.316,62.011,21.656,56.058,21.491,9.971,22.423,46.565,-0.976,31.026,40.309,30.703,39.666,15.7,33.42,46.861,26.019,36.491],"community":["1","1","1","6","1","1","7","1","1","2","7","7","3","1","5","5","2","2","4","2","2","7","7","8","3","3","3","5","3","5","5","2","2","4","4","4","2","2","7","8","8","8","3","3","6","6","6","6","5","5","5","5","5"],"label":["Lebanon","Argentina","Turkey","Ghana","Ukraine","Brazil","Uruguay","Russia","Mexico","Egypt","Hungary","Poland","India","United States","South Africa","Chile","Peru","Kuwait","New Zealand","Philippines","Czech Republic","Canada","Germany","Spain","Saudi Arabia","Australia","Austria","Netherlands","Croatia","United Kingdom","United Arab Emirates","South Korea","Malaysia","Belgium","Singapore","Qatar","Sweden","Oman","Denmark","Viet Nam","Costa Rica","Hong Kong","France","Indonesia","Israel","Portugal","Jordan","Greece","Thailand","China","Switzerland","Bahrain","Japan"],"color":["#E41A1C","#E41A1C","#E41A1C","#FFFF33","#E41A1C","#E41A1C","#A65628","#E41A1C","#E41A1C","#377EB8","#A65628","#A65628","#4DAF4A","#E41A1C","#FF7F00","#FF7F00","#377EB8","#377EB8","#984EA3","#377EB8","#377EB8","#A65628","#A65628","#F781BF","#4DAF4A","#4DAF4A","#4DAF4A","#FF7F00","#4DAF4A","#FF7F00","#FF7F00","#377EB8","#377EB8","#984EA3","#984EA3","#984EA3","#377EB8","#377EB8","#A65628","#F781BF","#F781BF","#F781BF","#4DAF4A","#4DAF4A","#FFFF33","#FFFF33","#FFFF33","#FFFF33","#FF7F00","#FF7F00","#FF7F00","#FF7F00","#FF7F00"],"x":[-1,-0.863628924721735,0.4270881514358933,0.9996851228659669,-0.009066121308439534,-0.4769803744342281,-0.1343580085239473,0.1197921209776054,0.04551612242133807,0.2678327244544825,0.4090202161167655,-0.02216764329147081,1,0.1782682928533317,0.5738289805342864,-0.2221209221379782,-0.1370218337530899,-0.9369728863701923,-0.007924409566172574,-0.1973919676965707,0.1945450674100975,-0.06963493346947802,0.6475387183692898,0.1587554686393,0.2728378785118726,-0.7004680495296414,-0.2267270008554328,-0.9958964623639609,0.03301615787371892,-0.8566346014225003,0.099130708925246,0.445048694611303,0.1116828480848735,-0.09306537706774609,0.3124349322676376,0.2274371418173131,0.7943748121440817,-0.9734168295313076,-0.01257758452386759,-0.1228971273468089,-0.03288767179362795,0.02473203283575609,0.4789873250956542,0.4607073223861464,0.5880868034000402,0.08809814748916622,0.3347152892556293,0.9812750370342365,0.5128475239811763,0.2474336743474097,0.6217474119062989,-0.2934871499313411,0.4409267988423451],"y":[-0.112718009247372,-0.6157824011485143,0.6878028411653112,0.174728110751768,0.3511642127281573,-0.2348259461757537,0.4445389800088468,-0.6068732430576125,0.03981210335218877,-0.7967597056441127,-0.4091253038072422,-0.7320328000220861,0.2860795764178952,0.3475728737263373,-0.3031294123492825,-0.3690835584249089,-0.3398733325002824,0.0602334173436152,0.2311028790356571,-0.778152759158772,0.08968575150583202,-0.1342370215069558,-0.04666505764430062,0.5820415497952911,0.4706100781867875,-0.443100788163164,-0.5507923788973024,-0.006691888914315935,-0.9578821675904068,-0.1065233769803648,0.6686339391414269,0.1373545472543483,0.01222352555404016,-0.9444365130633007,-0.6372964492888563,0.568572793073695,0.2392085863709215,-0.216856587050905,-0.2997921195825061,0.0672350896125955,-1,-0.5129710383634769,-0.6079879211920063,-0.1304753896637346,1,0.5191745590537697,0.8257862642019471,0.3945814273378674,0.7826831119128519,-0.1600792730678465,0.487960568306457,-0.9715116754279548,0.3231984274309001]},"edges":{"from":[1,2,3,3,3,4,4,4,4,5,5,5,6,6,7,7,7,7,8,8,9,9,9,9,9,10,10,10,10,10,11,11,12,12,13,13,13,13,13,13,14,15,16,16,16,16,17,17,18,18,19,19,19,19,20,20,21,21,22,22,23,23,24,24,24,24,26,26,27,28,28,28,28,28,29,30,31,32,33,34,35,36,37,38,39,40,41,43,44,45,46,47,48,49,50,51,52,53],"to":[2,3,4,5,6,45,46,47,48,7,8,9,9,10,10,11,12,13,13,14,14,15,16,17,19,17,18,19,20,21,21,22,22,23,23,24,25,26,27,28,28,28,28,29,30,31,31,32,32,33,9,34,35,36,9,37,37,38,38,39,28,39,39,40,41,42,43,44,44,49,50,51,52,53,44,53,53,17,18,19,19,19,21,21,22,42,42,26,27,4,4,4,4,28,28,28,28,28],"Value":[2,18,18,17,7,5,1,21,3,13,3,11,3,9,3,5,6,2,13,2,4,9,18,2,1,2,8,12,4,3,4,7,5,5,2,1,5,9,1,2,10,7,1,6,19,7,3,2,11,5,5,13,3,3,9,1,6,8,5,16,2,1,2,3,2,6,5,2,3,7,5,6,15,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"physics":false,"id":{"colour":"community"},"shape":"dot","font":{"size":35,"face":"arial","color":"#000000","bold":"true"},"scaling":{"label":{"enabled":true}}},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"layout":{"randomSeed":123}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="Callout:Insights">
<ol type="1">
<li>Leading Eigenvector</li>
</ol>
<p>Insight: This method often identifies communities based on the influence of nodes. Nodes with high eigenvector centrality are connected to other influential nodes, which can form a community. Implication for Big Mac Index: Communities identified by the Leading Eigenvector method might represent countries with influential trade relationships or economic ties that can impact the Big Mac Index through pricing standards, trade agreements, or shared economic policies.</p>
<ol start="2" type="1">
<li>Walktrap</li>
</ol>
<p>Insight: Walktrap finds communities by simulating random walks on the network, with the idea that walks are “trapped” within densely connected parts of the graph. Implication for Big Mac Index: The communities detected could reflect clusters of countries where trade flow is more frequent or robust, possibly due to geographic proximity or trade agreements, which in turn may affect the local pricing strategies included in the Big Mac Index.</p>
<ol start="3" type="1">
<li>Spinglass</li>
</ol>
<p>Insight: This method uses a spin model from statistical mechanics and is particularly good at detecting community structures where communities may be hierarchically nested. Implication for Big Mac Index: Spinglass communities may reflect complex and layered trade relationships, possibly uncovering hierarchies in economic interactions that could influence the Big Mac Index.</p>
<ol start="4" type="1">
<li>Comparison Summary:</li>
</ol>
<p>The Leading Eigenvector method might highlight dominant countries in trade that potentially set benchmarks for the Big Mac Index. The Walktrap method may reveal more about regional trading blocks or groups of countries with stronger internal trade links that could have similar Big Mac pricing due to shared market conditions. The Spinglass method can uncover more nuanced and multi-level communities, possibly highlighting intricate trade relationships and their cascading effects on the Big Mac Index.</p>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>